<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot function for class TP — plot.TP • statgenHTP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot function for class TP — plot.TP"><meta name="description" content="Plotting function for objects of class TP. Plots the layout of the platform
for different time points within the TP object. Also a boxplot can be made
for selected traits and time points and a plot of correlations
between time points. Finally the raw data can be displayed per
genotype. A detailed description and optional extra parameters for the
different plots are given in the sections below."><meta property="og:description" content="Plotting function for objects of class TP. Plots the layout of the platform
for different time points within the TP object. Also a boxplot can be made
for selected traits and time points and a plot of correlations
between time points. Finally the raw data can be displayed per
genotype. A detailed description and optional extra parameters for the
different plots are given in the sections below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot function for class TP</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/R/createTimePoints.R" class="external-link"><code>R/createTimePoints.R</code></a></small>
      <div class="d-none name"><code>plot.TP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plotting function for objects of class TP. Plots the layout of the platform
for different time points within the TP object. Also a boxplot can be made
for selected traits and time points and a plot of correlations
between time points. Finally the raw data can be displayed per
genotype. A detailed description and optional extra parameters for the
different plots are given in the sections below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'TP'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  plotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"layout"</span>, <span class="st">"box"</span>, <span class="st">"cor"</span>, <span class="st">"raw"</span><span class="op">)</span>,</span>
<span>  timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  traits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outFile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outFileOpts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class TP.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra plot options. Described per plotType in their respective
section.</p></dd>


<dt id="arg-plottype">plotType<a class="anchor" aria-label="anchor" href="#arg-plottype"></a></dt>
<dd><p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p></dd>


<dt id="arg-timepoints">timePoints<a class="anchor" aria-label="anchor" href="#arg-timepoints"></a></dt>
<dd><p>A character or numeric vector indicating the time points
to be plotted. When using a character string to reference a time point, the
value has to be an exact match to one of the existing timePoints. When using
a number it will be matched by its number ("timeNumber") in the timePoints
attribute of the TP object.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>A character vector indicating the traits to be plotted.
If <code>plotType</code> = "layout" only a single trait may be plotted. For the
other plotTypes, providing multiple traits will create multiple plots.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p></dd>


<dt id="arg-outfile">outFile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p></dd>


<dt id="arg-outfileopts">outFileOpts<a class="anchor" aria-label="anchor" href="#arg-outfileopts"></a></dt>
<dd><p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></code> for all possible options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Depending on the plot type, either a ggplot object or a list of
ggplot objects is invisibly returned.</p>
    </div>
    <div class="section level2">
    <h2 id="layout-plot">Layout Plot<a class="anchor" aria-label="anchor" href="#layout-plot"></a></h2>


<p>Plots the layout of the platform for selected time points (all available time
points by  default). This plot can only be made for time points that contain
both row (<code>rowNum</code>) and column (<code>colNum</code>) information. If either
one of those is missing the timePoint is skipped with a warning.
If replicates (<code>repId</code>) are available, a black line is plotted between
diffent replicates. Missing plots are indicated in white. This can either be
single plots in a time point or complete missing columns or rows.<br>
Extra parameter options:</p><dl><dt>showGeno</dt>
<dd><p>Should individual genotypes be labeled in the plot?
Defaults to <code>FALSE</code></p></dd>

<dt>highlight</dt>
<dd><p>A character vector of genotypes to be highlighted in the
plot.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="box-plot">Box Plot<a class="anchor" aria-label="anchor" href="#box-plot"></a></h2>


<p>Creates a boxplot per selected trait grouped by time point (all available
time points by  default). Extra parameter options:</p><dl><dt>groupBy</dt>
<dd><p>A character string indicating a column in <code>TP</code> by which
the boxes in the plot should be grouped.
By default the boxes are grouped per time point.</p></dd>

<dt>colorBy</dt>
<dd><p>A character string indicating a column in <code>TP</code> by which
the boxes are colored. Coloring will be done within the groups indicated by
the <code>groupBy</code> parameter, e.g. per replicate within each time point
using <code>repId</code>.</p></dd>

<dt>orderBy</dt>
<dd><p>A character string indicating the way the boxes should be
ordered. Either "alphabetic" for alphabetical ordering of the groups,
"ascending" for ordering by ascending mean, or "descending" for ordering by
descending mean. By default boxes are ordered alphabetically.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="correlation-plot">Correlation Plot<a class="anchor" aria-label="anchor" href="#correlation-plot"></a></h2>


<p>Draws a heatmap of correlations of raw data between time points per selected
trait for selected time points (all available time points by default).</p>
    </div>
    <div class="section level2">
    <h2 id="raw-data-plot">Raw data plot<a class="anchor" aria-label="anchor" href="#raw-data-plot"></a></h2>


<p>Create a plot of the raw data of the selected trait over time for selected
time points (all available time points by default). Plots are grouped by
genotype, or by genotype x treatment when the <code>geno.decomp</code> option is
specified. By default, all the genotypes will be plotted which might take
time and memory when the output is not saved in a file (see parameter
<code>outFile</code>). Extra parameter options:</p><dl><dt>genotypes</dt>
<dd><p>A character vector indicating the genotypes to be plotted.</p></dd>

<dt>geno.decomp</dt>
<dd><p>A character vector indicating the grouping of the
genotypes to be plotted.</p></dd>

<dt>plotLine</dt>
<dd><p>Should the data be displayed as lines? Default is FALSE.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for data preparation:
<code><a href="as.data.frame.TP.html">as.data.frame.TP</a>()</code>,
<code><a href="createTimePoints.html">createTimePoints</a>()</code>,
<code><a href="getTimePoints.html">getTimePoints</a>()</code>,
<code><a href="removeTimePoints.html">removeTimePoints</a>()</code>,
<code><a href="summary.TP.html">summary.TP</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Create a TP object containing the data from the Phenovator.</span></span></span>
<span class="r-in"><span><span class="va">phenoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="createTimePoints.html">createTimePoints</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">PhenovatorDat1</span>,</span></span>
<span class="r-in"><span>                            experimentName <span class="op">=</span> <span class="st">"Phenovator"</span>,</span></span>
<span class="r-in"><span>                            genotype <span class="op">=</span> <span class="st">"Genotype"</span>,</span></span>
<span class="r-in"><span>                            timePoint <span class="op">=</span> <span class="st">"timepoints"</span>,</span></span>
<span class="r-in"><span>                            repId <span class="op">=</span> <span class="st">"Replicate"</span>,</span></span>
<span class="r-in"><span>                            plotId <span class="op">=</span> <span class="st">"pos"</span>,</span></span>
<span class="r-in"><span>                            rowNum <span class="op">=</span> <span class="st">"y"</span>, colNum <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>                            addCheck <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            checkGenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>,</span></span>
<span class="r-in"><span>                                               <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following plotIds have observations for less than 50% of the time points:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> c24r41, c7r18, c7r49</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the layout for the third time point with the check genotypes</span></span></span>
<span class="r-in"><span><span class="co">## highlighted</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"layout"</span>,</span></span>
<span class="r-in"><span>     timePoints <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>     highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>, <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.TP-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a boxplot for "EffpsII" with 5 time points and boxes colored</span></span></span>
<span class="r-in"><span><span class="co">## by "repId" within time point.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"box"</span>,</span></span>
<span class="r-in"><span>     traits <span class="op">=</span> <span class="st">"EffpsII"</span>,</span></span>
<span class="r-in"><span>     timePoints <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>     colorBy <span class="op">=</span> <span class="st">"repId"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.TP-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a correlation plot for "EffpsII" for a selection of time points.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"cor"</span>,</span></span>
<span class="r-in"><span>     traits <span class="op">=</span> <span class="st">"EffpsII"</span>,</span></span>
<span class="r-in"><span>     timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span>, to<span class="op">=</span><span class="fl">73</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.TP-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the raw data of four genotypes for the trait "EffpsII":</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>,</span></span>
<span class="r-in"><span>     traits <span class="op">=</span> <span class="st">"EffpsII"</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"raw"</span>,</span></span>
<span class="r-in"><span>     genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G001"</span>,<span class="st">"G002"</span>,<span class="st">"check1"</span>,<span class="st">"check2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.TP-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

