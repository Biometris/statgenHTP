<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict the P-Splines Hierarchical Curve Data Model — predict.psHDM • statgenHTP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict the P-Splines Hierarchical Curve Data Model — predict.psHDM"><meta name="description" content="Function that predicts the P-spline Hierarchical Curve Data Model (see
fitSplineHDM) on a dense grid. It provides standard errors
for curves at each level of the hierarchy. User has to be aware that
standard errors at the plot level demand large memory. We suggest set
that option at the FALSE level"><meta property="og:description" content="Function that predicts the P-spline Hierarchical Curve Data Model (see
fitSplineHDM) on a dense grid. It provides standard errors
for curves at each level of the hierarchy. User has to be aware that
standard errors at the plot level demand large memory. We suggest set
that option at the FALSE level"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predict the P-Splines Hierarchical Curve Data Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/R/predict.psHDM.R" class="external-link"><code>R/predict.psHDM.R</code></a></small>
      <div class="d-none name"><code>predict.psHDM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function that predicts the P-spline Hierarchical Curve Data Model (see
<code><a href="fitSplineHDM.html">fitSplineHDM</a></code>) on a dense grid. It provides standard errors
for curves at each level of the hierarchy. User has to be aware that
standard errors at the plot level demand large memory. We suggest set
that option at the <code>FALSE</code> level</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'psHDM'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newtimes</span>,</span>
<span>  pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class "psHDM" as obtained after fitting
(<code><a href="fitSplineHDM.html">fitSplineHDM</a></code>) the P-spline Hierarchical Curve Data Model</p></dd>


<dt id="arg-newtimes">newtimes<a class="anchor" aria-label="anchor" href="#arg-newtimes"></a></dt>
<dd><p>A numeric vector with timepoints at which predictions are
desired</p></dd>


<dt id="arg-pred">pred<a class="anchor" aria-label="anchor" href="#arg-pred"></a></dt>
<dd><p>A list that controls the hierarchical levels at which
predictions are desired (population/genotypes/plots).  The default is
<code>TRUE</code>.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A list that controls the hierarchical levels at which standard
errors are desired (population/genotypes/plots).  The default is
<code>TRUE</code> except at the plot level.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>An optional value that controls the function trace.
The default is <code>TRUE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>psHDM</code>, a list with the following outputs:
predict.psHDM
<code>newtimes</code> A numeric vector with the timepoints at which predictions
and/or standard errors have been obtained.
<code>popLevel</code> A data.frame with the estimated population trajectories
and first and second order derivatives, and if required their respective
standard errors, at the <code>newtimes</code>.
<code>genoLevel</code> A data.frame with the estimated genotype-specific
deviations and trajectories and their respective first and second order
derivatives, and if required their respective standard errors,
at the <code>newtimes</code>.
<code>plotLevel</code> A data.frame with the estimated plot-specific
deviations and trajectories and their respective first and second order
derivatives, and if required their respective standard errors,
at the <code>newtimes</code>.
<code>plotObs</code> A data.frame with the raw data at the original timepoints.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pérez-Valencia, D.M., Rodríguez-Álvarez, M.X., Boer, M.P. et al.
A two-stage approach for the spatio-temporal analysis of high-throughput
phenotyping data. Sci Rep 12, 3177 (2022). <a href="https://doi.org/10.1038/s41598-022-06935-9" class="external-link">doi:10.1038/s41598-022-06935-9</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for fitting hierarchical curve data models:
<code><a href="fitSplineHDM.html">fitSplineHDM</a>()</code>,
<code><a href="plot.psHDM.html">plot.psHDM</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## The data from the Phenovator platform have been corrected for spatial</span></span></span>
<span class="r-in"><span><span class="co">## trends and outliers for single observations have been removed.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We need to specify the genotype-by-treatment interaction.</span></span></span>
<span class="r-in"><span><span class="co">## Treatment: water regime (WW, WD).</span></span></span>
<span class="r-in"><span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"geno.decomp"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                      start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genoTreat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genotype"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.</span></span></span>
<span class="r-in"><span><span class="va">fit.psHDM</span>  <span class="op">&lt;-</span> <span class="fu"><a href="fitSplineHDM.html">fitSplineHDM</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedArch</span>,</span></span>
<span class="r-in"><span>                          trait <span class="op">=</span> <span class="st">"LeafArea_corr"</span>,</span></span>
<span class="r-in"><span>                          genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GenoA14_WD"</span>, <span class="st">"GenoA51_WD"</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"GenoB11_WW"</span>, <span class="st">"GenoB02_WD"</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"GenoB02_WW"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          time <span class="op">=</span> <span class="st">"timeNumber"</span>,</span></span>
<span class="r-in"><span>                          pop <span class="op">=</span> <span class="st">"geno.decomp"</span>,</span></span>
<span class="r-in"><span>                          genotype <span class="op">=</span> <span class="st">"genoTreat"</span>,</span></span>
<span class="r-in"><span>                          plotId <span class="op">=</span> <span class="st">"plotId"</span>,</span></span>
<span class="r-in"><span>                          difVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          smoothPop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">4</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          smoothGeno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">4</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          smoothPlot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">4</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          weights <span class="op">=</span> <span class="st">"wt"</span>,</span></span>
<span class="r-in"><span>                          trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Predict the P-Splines Hierarchical Curve Data Model on a dense grid</span></span></span>
<span class="r-in"><span><span class="co">## with standard errors at the population and genotype levels</span></span></span>
<span class="r-in"><span><span class="va">pred.psHDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit.psHDM</span>,</span></span>
<span class="r-in"><span>                     newtimes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Population-specific growth curves OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Standard errors for population-specific growth curves OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Genotype-specific deviations OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Genotype-specific growth curves OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Standard errors for genotype-specific deviations OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Standard errors for genotype-specific growth curves OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Plot-specific deviations OK"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Plot-specific growth curves OK"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the P-Spline predictions at the three levels of the hierarchy</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plots at population level.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>,</span></span>
<span class="r-in"><span>    plotType <span class="op">=</span> <span class="st">"popTra"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.psHDM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plots at genotype level.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>,</span></span>
<span class="r-in"><span>    plotType <span class="op">=</span> <span class="st">"popGenoTra"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.psHDM-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plots of derivatives at genotype level.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>,</span></span>
<span class="r-in"><span>    plotType <span class="op">=</span> <span class="st">"popGenoDeriv"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.psHDM-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plots of deviations at genotype level.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>,</span></span>
<span class="r-in"><span>    plotType <span class="op">=</span> <span class="st">"genoDev"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.psHDM-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plots at plot level.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>,</span></span>
<span class="r-in"><span>    plotType <span class="op">=</span> <span class="st">"genoPlotTra"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.psHDM-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

