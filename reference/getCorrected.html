<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extract corrected phenotypic values from an object of class fitMod. After
fitting a spatial model at each time point, the raw phenotypic data is
corrected by subtracting the (estimated) sources of variation (environmental,
design  effect) that are of no interest (nuisances). This allows keeping
the data resolution at the plot/plant level."><title>Extract corrected phenotypic values — getCorrected • statgenHTP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract corrected phenotypic values — getCorrected"><meta property="og:description" content="Extract corrected phenotypic values from an object of class fitMod. After
fitting a spatial model at each time point, the raw phenotypic data is
corrected by subtracting the (estimated) sources of variation (environmental,
design  effect) that are of no interest (nuisances). This allows keeping
the data resolution at the plot/plant level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extract corrected phenotypic values</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/HEAD/R/getMethods.R" class="external-link"><code>R/getMethods.R</code></a></small>
      <div class="d-none name"><code>getCorrected.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract corrected phenotypic values from an object of class fitMod. After
fitting a spatial model at each time point, the raw phenotypic data is
corrected by subtracting the (estimated) sources of variation (environmental,
design  effect) that are of no interest (nuisances). This allows keeping
the data resolution at the plot/plant level.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getCorrected</span><span class="op">(</span><span class="va">fitMod</span>, timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fitMod</span><span class="op">)</span>, outFile <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>fitMod</dt>
<dd><p>An object of class <code>fitMod</code>.</p></dd>


<dt>timePoints</dt>
<dd><p>A character or numeric vector indicating the time point(s)
for which the corrected values should be extracted. When using a character
string to reference a time point, the value has to be an exact match to one
of the existing time points. When using a number it will be matched by its
number ("timeNumber") in the timePoints attribute of the TP object.</p></dd>


<dt>outFile</dt>
<dd><p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data.frame with spatially corrected values per time point.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for spatial modeling: 
<code><a href="fitModels.html">fitModels</a>()</code>,
<code><a href="getEffDims.html">getEffDims</a>()</code>,
<code><a href="getGenoPred.html">getGenoPred</a>()</code>,
<code><a href="getHerit.html">getHerit</a>()</code>,
<code><a href="getVar.html">getVar</a>()</code>,
<code><a href="plot.fitMod.html">plot.fitMod</a>()</code>,
<code><a href="summary.fitMod.html">summary.fitMod</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Using the first example dataset (PhenovatorDat1).</span></span></span>
<span class="r-in"><span><span class="va">phenoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="createTimePoints.html">createTimePoints</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">PhenovatorDat1</span>,</span></span>
<span class="r-in"><span>                            experimentName <span class="op">=</span> <span class="st">"Phenovator"</span>,</span></span>
<span class="r-in"><span>                            genotype <span class="op">=</span> <span class="st">"Genotype"</span>,</span></span>
<span class="r-in"><span>                            timePoint <span class="op">=</span> <span class="st">"timepoints"</span>,</span></span>
<span class="r-in"><span>                            repId <span class="op">=</span> <span class="st">"Replicate"</span>,</span></span>
<span class="r-in"><span>                            plotId <span class="op">=</span> <span class="st">"pos"</span>,</span></span>
<span class="r-in"><span>                            rowNum <span class="op">=</span> <span class="st">"y"</span>, colNum <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>                            addCheck <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            checkGenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>,</span></span>
<span class="r-in"><span>                                               <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following plotIds have observations for less than 50% of the time points:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> c24r41, c7r18, c7r49</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit a SpATS model on few time points.</span></span></span>
<span class="r-in"><span><span class="va">modPhenoSp</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitModels.html">fitModels</a></span><span class="op">(</span>TP <span class="op">=</span> <span class="va">phenoTP</span>,</span></span>
<span class="r-in"><span>                        trait <span class="op">=</span> <span class="st">"EffpsII"</span>,</span></span>
<span class="r-in"><span>                        timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2018-05-31 16:37:00</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2018-06-02 09:07:00</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2018-06-05 14:37:00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the corrected values for one time point:</span></span></span>
<span class="r-in"><span><span class="va">spatCorrSp</span> <span class="op">&lt;-</span> <span class="fu">getCorrected</span><span class="op">(</span><span class="va">modPhenoSp</span>,</span></span>
<span class="r-in"><span>                           timePoints <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spatCorrSp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   timeNumber           timePoint EffpsII_corr EffpsII       wt genotype rowId</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          6 2018-06-02 09:07:00    0.6810552   0.678 1636.287     G001    32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          6 2018-06-02 09:07:00    0.6625282   0.659 1636.287     G001    58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          6 2018-06-02 09:07:00    0.6286591   0.630 1636.287     G001    21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          6 2018-06-02 09:07:00    0.7115547   0.722 1636.287     G001    22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          6 2018-06-02 09:07:00    0.6764931   0.682 1636.287     G001    33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          6 2018-06-02 09:07:00    0.6455498   0.641 1636.287     G001     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   colId plotId</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    14 c14r32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    17 c17r58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    20 c20r21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6  c6r22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5  c5r33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    21  c21r8</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

