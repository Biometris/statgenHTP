<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect outliers for series of observations — detectSerieOut • statgenHTP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect outliers for series of observations — detectSerieOut"><meta name="description" content="Function for detecting strange time courses. The function uses the estimates
for the spline coefficients per time course (typically per plant).
Correlations between those coefficient vectors are calculated to identify
outlying time courses, i.e., plants. An outlying time course will have low
correlation to the majority of time courses. To support the analysis by
correlations, a principal component analysis is done on the plant
(time course) by spline coefficient matrix. A PCA plot of the plant scores
will show the outlying plants. Finally the pairwise-ratios of the slopes of
a linear model fitted through the spline coefficients are computed. Plants
are tagged when the average pairwise-ratio is lower the a given threshold
(thrSlope)."><meta property="og:description" content="Function for detecting strange time courses. The function uses the estimates
for the spline coefficients per time course (typically per plant).
Correlations between those coefficient vectors are calculated to identify
outlying time courses, i.e., plants. An outlying time course will have low
correlation to the majority of time courses. To support the analysis by
correlations, a principal component analysis is done on the plant
(time course) by spline coefficient matrix. A PCA plot of the plant scores
will show the outlying plants. Finally the pairwise-ratios of the slopes of
a linear model fitted through the spline coefficients are computed. Plants
are tagged when the average pairwise-ratio is lower the a given threshold
(thrSlope)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect outliers for series of observations</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/R/detectSerieOut.R" class="external-link"><code>R/detectSerieOut.R</code></a></small>
      <div class="d-none name"><code>detectSerieOut.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for detecting strange time courses. The function uses the estimates
for the spline coefficients per time course (typically per plant).
Correlations between those coefficient vectors are calculated to identify
outlying time courses, i.e., plants. An outlying time course will have low
correlation to the majority of time courses. To support the analysis by
correlations, a principal component analysis is done on the plant
(time course) by spline coefficient matrix. A PCA plot of the plant scores
will show the outlying plants. Finally the pairwise-ratios of the slopes of
a linear model fitted through the spline coefficients are computed. Plants
are tagged when the average pairwise-ratio is lower the a given threshold
(<code>thrSlope</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detectSerieOut</span><span class="op">(</span></span>
<span>  <span class="va">corrDat</span>,</span>
<span>  <span class="va">predDat</span>,</span>
<span>  <span class="va">coefDat</span>,</span>
<span>  <span class="va">trait</span>,</span>
<span>  genotypes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geno.decomp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thrCor <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  thrPca <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  thrSlope <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-corrdat">corrDat<a class="anchor" aria-label="anchor" href="#arg-corrdat"></a></dt>
<dd><p>A data.frame with corrected spatial data.</p></dd>


<dt id="arg-preddat">predDat<a class="anchor" aria-label="anchor" href="#arg-preddat"></a></dt>
<dd><p>A data.frame with predicted data from a fitted spline.</p></dd>


<dt id="arg-coefdat">coefDat<a class="anchor" aria-label="anchor" href="#arg-coefdat"></a></dt>
<dd><p>A data.frame with coefficients from a fitted spline.</p></dd>


<dt id="arg-trait">trait<a class="anchor" aria-label="anchor" href="#arg-trait"></a></dt>
<dd><p>A character string indicating the trait for which to detect
outliers.</p></dd>


<dt id="arg-genotypes">genotypes<a class="anchor" aria-label="anchor" href="#arg-genotypes"></a></dt>
<dd><p>A character vector indicating the genotypes for which to
detect outliers. If <code>NULL</code>, outlier detection will be done for all
genotypes.</p></dd>


<dt id="arg-geno-decomp">geno.decomp<a class="anchor" aria-label="anchor" href="#arg-geno-decomp"></a></dt>
<dd><p>A character vector indicating the variables to use to
group the genotypic variance in the model.</p></dd>


<dt id="arg-thrcor">thrCor<a class="anchor" aria-label="anchor" href="#arg-thrcor"></a></dt>
<dd><p>A numerical value used as threshold for determining outliers
based on correlation between plots.</p></dd>


<dt id="arg-thrpca">thrPca<a class="anchor" aria-label="anchor" href="#arg-thrpca"></a></dt>
<dd><p>A numerical value used as threshold for determining outliers
based on angles (in degrees) between PCA scores.</p></dd>


<dt id="arg-thrslope">thrSlope<a class="anchor" aria-label="anchor" href="#arg-thrslope"></a></dt>
<dd><p>A numerical value used as threshold for determining outliers
based on slopes.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>serieOut</code>, a <code>data.frame</code> with outlying
series of observations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for detecting outliers for series of observations:
<code><a href="plot.serieOut.html">plot.serieOut</a>()</code>,
<code><a href="removeSerieOut.html">removeSerieOut</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## The data from the Phenovator platform have been corrected for spatial</span></span></span>
<span class="r-in"><span><span class="co">## trends and outliers for single observations have been removed.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit P-splines on a subset of genotypes</span></span></span>
<span class="r-in"><span><span class="va">subGenoVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G160"</span>, <span class="st">"G151"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitSpline.html">fitSpline</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,</span></span>
<span class="r-in"><span>                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,</span></span>
<span class="r-in"><span>                        genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,</span></span>
<span class="r-in"><span>                        knots <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the data.frames with predicted values and P-Spline coefficients.</span></span></span>
<span class="r-in"><span><span class="va">predDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">predDat</span></span></span>
<span class="r-in"><span><span class="va">coefDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">coefDat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The coefficients are then used to tag suspect time courses.</span></span></span>
<span class="r-in"><span><span class="va">outVator</span> <span class="op">&lt;-</span> <span class="fu">detectSerieOut</span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,</span></span>
<span class="r-in"><span>                           predDat <span class="op">=</span> <span class="va">predDat</span>,</span></span>
<span class="r-in"><span>                           coefDat <span class="op">=</span> <span class="va">coefDat</span>,</span></span>
<span class="r-in"><span>                           trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,</span></span>
<span class="r-in"><span>                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,</span></span>
<span class="r-in"><span>                           thrCor <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                           thrPca <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>                           thrSlope <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The `outVator` can be visualized for selected genotypes.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outVator</span>, genotypes <span class="op">=</span> <span class="st">"G151"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="detectSerieOut-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

