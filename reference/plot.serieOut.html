<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot outliers for series of observations — plot.serieOut • statgenHTP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot outliers for series of observations — plot.serieOut"><meta name="description" content="Plot the fitted spline, correlation matrix and PCA biplot for each of the
genotypes. Outlying series of observations are shown as filled dots in the
fitted spline plot, other observations are shown as open dots."><meta property="og:description" content="Plot the fitted spline, correlation matrix and PCA biplot for each of the
genotypes. Outlying series of observations are shown as filled dots in the
fitted spline plot, other observations are shown as open dots."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot outliers for series of observations</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/R/detectSerieOut.R" class="external-link"><code>R/detectSerieOut.R</code></a></small>
      <div class="d-none name"><code>plot.serieOut.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot the fitted spline, correlation matrix and PCA biplot for each of the
genotypes. Outlying series of observations are shown as filled dots in the
fitted spline plot, other observations are shown as open dots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'serieOut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  reason <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean corr"</span>, <span class="st">"angle"</span>, <span class="st">"slope"</span><span class="op">)</span>,</span>
<span>  genotypes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geno.decomp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useTimeNumber <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timeNumber <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>serieOut</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored.</p></dd>


<dt id="arg-reason">reason<a class="anchor" aria-label="anchor" href="#arg-reason"></a></dt>
<dd><p>A character vector indicating which types of outliers should
be plotted.</p></dd>


<dt id="arg-genotypes">genotypes<a class="anchor" aria-label="anchor" href="#arg-genotypes"></a></dt>
<dd><p>A character vector indicating which genotypes should be
plotted. If <code>NULL</code> all genotypes are plotted.</p></dd>


<dt id="arg-geno-decomp">geno.decomp<a class="anchor" aria-label="anchor" href="#arg-geno-decomp"></a></dt>
<dd><p>A character vector indicating which levels of
<code>geno.decomp</code> should be plotted. If <code>NULL</code> all levels are plotted.
Ignored if <code>geno.decomp</code> was not used when fitting models.</p></dd>


<dt id="arg-usetimenumber">useTimeNumber<a class="anchor" aria-label="anchor" href="#arg-usetimenumber"></a></dt>
<dd><p>Should the timeNumber be used instead of the timePoint
in the labels on the x-axis?</p></dd>


<dt id="arg-timenumber">timeNumber<a class="anchor" aria-label="anchor" href="#arg-timenumber"></a></dt>
<dd><p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of ggplot objects is invisibly returned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for detecting outliers for series of observations:
<code><a href="detectSerieOut.html">detectSerieOut</a>()</code>,
<code><a href="removeSerieOut.html">removeSerieOut</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## The data from the Phenovator platform have been corrected for spatial</span></span></span>
<span class="r-in"><span><span class="co">## trends and outliers for single observations have been removed.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit P-splines on a subset of genotypes</span></span></span>
<span class="r-in"><span><span class="va">subGenoVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G160"</span>, <span class="st">"G151"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitSpline.html">fitSpline</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,</span></span>
<span class="r-in"><span>                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,</span></span>
<span class="r-in"><span>                        genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,</span></span>
<span class="r-in"><span>                        knots <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the data.frames with predicted values and P-Spline coefficients.</span></span></span>
<span class="r-in"><span><span class="va">predDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">predDat</span></span></span>
<span class="r-in"><span><span class="va">coefDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">coefDat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The coefficients are then used to tag suspect time courses.</span></span></span>
<span class="r-in"><span><span class="va">outVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="detectSerieOut.html">detectSerieOut</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,</span></span>
<span class="r-in"><span>                           predDat <span class="op">=</span> <span class="va">predDat</span>,</span></span>
<span class="r-in"><span>                           coefDat <span class="op">=</span> <span class="va">coefDat</span>,</span></span>
<span class="r-in"><span>                           trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,</span></span>
<span class="r-in"><span>                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,</span></span>
<span class="r-in"><span>                           thrCor <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                           thrPca <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>                           thrSlope <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The `outVator` can be visualized for selected genotypes.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outVator</span>, genotypes <span class="op">=</span> <span class="st">"G151"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.serieOut-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Only visualize outliers tagged because of low correlation</span></span></span>
<span class="r-in"><span><span class="co">## between slopes of the regression.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outVator</span>, genotypes <span class="op">=</span> <span class="st">"G151"</span>, reason <span class="op">=</span> <span class="st">"slope"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.serieOut-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

