<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>statgenHTP: A short overview • statgenHTP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="statgenHTP: A short overview">
<meta property="og:description" content="statgenHTP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenHTP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenHTP">
    <span class="fas fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Overview_HTP_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>statgenHTP: A short overview</h1>
                        <h4 class="author">Emilie Millet, Bart-Jan van Rossum</h4>
            
            <h4 class="date">2021-06-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/master/vignettes/Overview_HTP.Rmd"><code>vignettes/Overview_HTP.Rmd</code></a></small>
      <div class="hidden name"><code>Overview_HTP.Rmd</code></div>

    </div>

    
    
<div id="the-statgenhtp-package" class="section level1">
<h1 class="hasAnchor">
<a href="#the-statgenhtp-package" class="anchor"></a>The statgenHTP Package</h1>
<p>The statgenHTP package is developed as an easy-to-use package for analyzing data coming from high throughput phenotyping (HTP) platform experiments. The package provides many options for plotting and exporting the results of the analyses. It was developed within the <a href="https://eppn2020.plant-phenotyping.eu/">EPPN<sup>2020</sup>project</a> to meet the needs for automated analyses of HTP data.</p>
<p>New phenotyping techniques enable measuring traits at high throughput, with traits being measured at multiple time points for hundreds or thousands of plants. This requires automatic modeling of the data <span class="citation">(Tardieu et al. 2017)</span> with a model that is robust, flexible and has easy selection steps.</p>
<p>The aim of this package is to provide a suit of functions to (1) detect outliers at the time point or at the plant levels, (2) accurately separate the genetic effects from the spatial effects at each time point and (3) estimate relevant parameters from a modeled time course. It will provide the user with either genotypic values or corrected values that can be used for further modeling, e.g. extract responses to environment <span class="citation">(Eeuwijk et al. 2019)</span>.</p>
<p><strong>Structure of the package</strong></p>
<p>The overall structure of the package is in 5 main parts:</p>
<ol style="list-style-type: decimal">
<li>Data description and preparation - <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/Intro_HTP.html"><em>statgenHTP tutorial: 1. Introduction, data description and preparation</em></a>
</li>
<li>Outlier detection: single observations - <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/OutlierSingleObs_HTP.html"><em>statgenHTP tutorial: 2. Outlier detection for single observations</em></a>
</li>
<li>Correction for spatial trends - <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/SpatialModel_HTP.html"><em>statgenHTP tutorial: 3. Correction for spatial trends</em></a>
</li>
<li>Outlier detection: series of observations - <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/OutlierSerieObs_HTP.html"><em>statgenHTP tutorial: 4. Outlier detection for series of observations</em></a>
</li>
<li>Parameter estimation - <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/ParameterEstimation_HTP.html"><em>statgenHTP tutorial: 5. Estimation of parameters for time courses</em></a>
</li>
</ol>
<p>This document gives an overview of these five steps and how to use the package to perform an analysis. For a more in depth description of the data, a theoretical background for the different steps and examples with additional data sets see the package <a href="https://biometris.github.io/statgenHTP/">website</a>.</p>
<hr>
</div>
<div id="data-description" class="section level1">
<h1 class="hasAnchor">
<a href="#data-description" class="anchor"></a>Data description</h1>
<div id="ex1" class="section level2">
<h2 class="hasAnchor">
<a href="#ex1" class="anchor"></a>Example 1: photosystem efficiency in Arabidopsis</h2>
<p>The used in this vignette contains data from an experiment in the Phenovator platform (WUR, Netherlands, <span class="citation">(Flood et al. 2016)</span>) with Arabidopsis plants. It consists of one experiment with 1440 plants grown in a growth chamber with different light intensity. The data set called “PhenovatorDat1” is included in the package.</p>
<p>The number of tested genotypes (<code>Genotype</code>) is 192 with 6-7 replicates per genotype (<code>Replicate</code>). Four reference genotypes were also tested with 15 or 30 replicates. The studied trait is the photosystem II efficiency (<code>EffpsII</code>) extracted from the pictures over time <span class="citation">(Rooijen et al. 2017)</span>. The unique ID of the plant is recorded (<code>pos</code>), together with the pot position in row (<code>x</code>) and in column (<code>y</code>). The data set also includes factors from the design: the position of the camera (<code>Image_pos</code>) and the pots table (<code>Basin</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"PhenovatorDat1"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">Genotype</th>
<th align="center">Basin</th>
<th align="center">Image_pos</th>
<th align="center">Replicate</th>
<th align="center">x</th>
<th align="center">y</th>
<th align="center">Sowing_Position</th>
<th align="center">timepoints</th>
<th align="center">EffpsII</th>
<th align="center">pos</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">0.685</td>
<td align="center">c14r32</td>
</tr>
<tr class="even">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-06-01 09:07:00</td>
<td align="center">0.688</td>
<td align="center">c14r32</td>
</tr>
<tr class="odd">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-06-01 11:37:00</td>
<td align="center">0.652</td>
<td align="center">c14r32</td>
</tr>
<tr class="even">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-06-01 14:37:00</td>
<td align="center">0.671</td>
<td align="center">c14r32</td>
</tr>
<tr class="odd">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-06-01 16:37:00</td>
<td align="center">0.616</td>
<td align="center">c14r32</td>
</tr>
<tr class="even">
<td align="center">G001</td>
<td align="center">2</td>
<td align="center">1b</td>
<td align="center">8</td>
<td align="center">14</td>
<td align="center">32</td>
<td align="center">8R02</td>
<td align="center">2018-06-02 09:07:00</td>
<td align="center">0.678</td>
<td align="center">c14r32</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="data-preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h1>
<p>The first step when modeling platform experiment data with the statgenHTP package is creating an object of class <code>TP</code> (Time Points). In this object, the time points are split into single <code>data.frames</code>. It is then used throughout the statgenHTP package as input for analyses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create a TP object containing the data from the Phenovator.</span>
<span class="va">phenoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTimePoints.html">createTimePoints</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">PhenovatorDat1</span>,
                            experimentName <span class="op">=</span> <span class="st">"Phenovator"</span>,
                            genotype <span class="op">=</span> <span class="st">"Genotype"</span>,
                            timePoint <span class="op">=</span> <span class="st">"timepoints"</span>,
                            repId <span class="op">=</span> <span class="st">"Replicate"</span>,
                            plotId <span class="op">=</span> <span class="st">"pos"</span>,
                            rowNum <span class="op">=</span> <span class="st">"y"</span>, colNum <span class="op">=</span> <span class="st">"x"</span>,
                            addCheck <span class="op">=</span> <span class="cn">TRUE</span>,
                            checkGenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>, <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: The following plotIds have observations for less than 50% of the time points:</span>
<span class="co">#&gt; c24r41, c7r18, c7r49</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">phenoTP</span><span class="op">)</span>
<span class="co">#&gt; phenoTP contains data for experiment Phenovator.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; It contains 73 time points.</span>
<span class="co">#&gt; First time point: 2018-05-31 16:37:00 </span>
<span class="co">#&gt; Last time point: 2018-06-18 16:37:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following genotypes are defined as check genotypes: check1, check2, check3, check4.</span></code></pre></div>
<p>In this data set, 3 plants contain less than 50% of the 73 time points. The user may choose to check the data for these plants and eventually to remove them from the data set.</p>
<p>The function <code>getTimePoints</code> allows to generate a <code>data.frame</code> containing the time points and their numbers in the <code>TP</code> object. Below is an example with the first 6 time points of the <code>phenoTP</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Extract the time points table.</span>
<span class="va">timepoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTimePoints.html">getTimePoints</a></span><span class="op">(</span><span class="va">phenoTP</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2018-06-01 09:07:00</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">2018-06-01 11:37:00</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">2018-06-01 14:37:00</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">2018-06-01 16:37:00</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">2018-06-02 09:07:00</td>
</tr>
</tbody>
</table>
</div>
<div id="data-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#data-visualization" class="anchor"></a>Data visualization</h1>
<p>Several plots can be made to further investigate the content of a <code>TP</code> object.</p>
<div id="layout-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#layout-plot" class="anchor"></a>Layout plot</h2>
<p>The first type of plot displays the layout of the experiment as a grid using the row and column coordinates. The default option creates plots of all time points in the <code>TP</code> object. This can be restricted to a selection of time points using their number in the option <code>timePoints</code>. If <code>repId</code> was specified when creating the <code>TP</code> object, replicate blocks are delineated by a black line. Missing plots are indicated in white enclosed with a bold black line. This type of plot allows checking the design of the experiment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot the layout for the third time point.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"layout"</span>,
     timePoints <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/layoutPlot-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Here, the third time point is displayed which corresponds to the 1<sup>st</sup> of June 2018 at 11:37. Note that the title can be manually changed using the <code>title</code> option. This plot can be extended by highlighting interesting genotypes in the layout. Hereafter the check genotypes are highlighted:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot the layout for the third time point with the check genotypes highlighted.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"layout"</span>,
     timePoints <span class="op">=</span> <span class="fl">3</span>,  
     highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>, <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/layoutPlotHL-1.png" width="480" style="display: block; margin: auto;"></p>
<p>It is possible to add the labels of the genotypes to the layout.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot the layout for the third time point.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"layout"</span>,
     timePoints <span class="op">=</span> <span class="fl">3</span>,  
     highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"check1"</span>, <span class="st">"check2"</span>, <span class="st">"check3"</span>, <span class="st">"check4"</span><span class="op">)</span>,
     showGeno <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/layoutPlotSG-1.png" width="768" style="display: block; margin: auto;"></p>
<p>We can visualize the raw data of a given trait on the layout, as a heatmap. This type of plot gives a first indication of the spatial variability at a given time point. This can be further investigated with the spatial modeling.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot the layout for the third time point.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"layout"</span>,
     timePoints <span class="op">=</span> <span class="fl">3</span>,  
     traits <span class="op">=</span> <span class="st">"EffpsII"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/layoutPlotheatmap-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="raw-data-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#raw-data-plot" class="anchor"></a>Raw data plot</h2>
<p>Raw data can be displayed per genotype with one color per plotId.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create the raw data time courses for three genotypes.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     traits <span class="op">=</span> <span class="st">"EffpsII"</span>,
     plotType <span class="op">=</span> <span class="st">"raw"</span>,
     genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G001"</span>, <span class="st">"G002"</span>, <span class="st">"check1"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/rawVator-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="boxplot" class="section level2">
<h2 class="hasAnchor">
<a href="#boxplot" class="anchor"></a>Boxplot</h2>
<p>Boxplots can be made to visually assess the variability of the trait(s) in the <code>TP</code> object. By default a box is plotted per time point for the specified trait using all time points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create a boxplot for "EffpsII" using the default all time points.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"box"</span>,
     traits <span class="op">=</span> <span class="st">"EffpsII"</span><span class="op">)</span> </code></pre></div>
<p><img src="Overview_HTP_files/figure-html/boxPlot-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="correlation-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-plot" class="anchor"></a>Correlation plot</h2>
<p>Finally, a plot of the correlations between the observations in time for a specified trait can be made. The order of the plot is chronological and by default all time points are used.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create a correlation plot for "EffpsII" for a selection of time points.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phenoTP</span>, 
     plotType <span class="op">=</span> <span class="st">"cor"</span>,
     traits <span class="op">=</span> <span class="st">"EffpsII"</span>,
     timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">73</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/corPlot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="outlier-detection-for-single-observations" class="section level1">
<h1 class="hasAnchor">
<a href="#outlier-detection-for-single-observations" class="anchor"></a>Outlier detection for single observations</h1>
<p>Time courses of phenotypic data are viewed as continuous time-related functions. The first cleaning step consists of roughly checking the consistency of each point with its neighbors within a time course. Outlying single observations are measurements that do not follow the expected behavior at a given time. The detection of outlying observations is done “one time course after the other.”</p>
<p>Local regression is used to locally approximate the time courses by parametric functions. First a local regression is fitted at a set of points, then the fit is interpolated to other points. A confidence interval can then be calculated. Points outside this interval will be annotated as outliers.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First select a subset of plants, for example here 4 plants.</span>
<span class="va">plantSel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c1r17"</span>,<span class="st">"c13r17"</span>,<span class="st">"c6r51"</span>,<span class="st">"c21r24"</span><span class="op">)</span> 
<span class="co"># Then run on the subset</span>
<span class="va">resuVatorHTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectSingleOut.html">detectSingleOut</a></span><span class="op">(</span>TP <span class="op">=</span> <span class="va">phenoTP</span>,
                                trait <span class="op">=</span> <span class="st">"EffpsII"</span>,
                                plotIds <span class="op">=</span> <span class="va">plantSel</span>,
                                confIntSize <span class="op">=</span> <span class="fl">3</span>,
                                nnLocfit <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">plotId</th>
<th align="center">timePoint</th>
<th align="center">EffpsII</th>
<th align="center">yPred</th>
<th align="center">sd_yPred</th>
<th align="center">lwr</th>
<th align="center">upr</th>
<th align="center">outlier</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">c13r17</td>
<td align="center">2018-06-03 09:07:00</td>
<td align="center">0.751</td>
<td align="center">0.6852574</td>
<td align="center">0.0389194</td>
<td align="center">0.5684992</td>
<td align="center">0.8020156</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">c13r17</td>
<td align="center">2018-06-03 11:37:00</td>
<td align="center">0.538</td>
<td align="center">0.6833963</td>
<td align="center">0.0255016</td>
<td align="center">0.6068916</td>
<td align="center">0.7599011</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">c13r17</td>
<td align="center">2018-06-03 14:37:00</td>
<td align="center">0.737</td>
<td align="center">0.7045487</td>
<td align="center">0.0342136</td>
<td align="center">0.6019078</td>
<td align="center">0.8071896</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">c13r17</td>
<td align="center">2018-06-04 09:07:00</td>
<td align="center">0.619</td>
<td align="center">0.6330957</td>
<td align="center">0.0436610</td>
<td align="center">0.5021126</td>
<td align="center">0.7640788</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">c13r17</td>
<td align="center">2018-06-04 11:37:00</td>
<td align="center">0.711</td>
<td align="center">0.6655915</td>
<td align="center">0.0322765</td>
<td align="center">0.5687620</td>
<td align="center">0.7624211</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">c13r17</td>
<td align="center">2018-06-04 14:37:00</td>
<td align="center">0.633</td>
<td align="center">0.6861254</td>
<td align="center">0.0330415</td>
<td align="center">0.5870010</td>
<td align="center">0.7852499</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>The predicted values and the confidence interval can be visualized using the <code>plot</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">resuVatorHTP</span>,
     outOnly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotOutVatorFA1-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The annotated points can be replaced by NA for the studied trait using the function <code>removeSingleOut</code>. It creates a new <code>TP</code> object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phenoTPOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeSingleOut.html">removeSingleOut</a></span><span class="op">(</span><span class="va">phenoTP</span>,
                              <span class="va">resuVatorHTP</span><span class="op">)</span></code></pre></div>
</div>
<div id="correction-for-spatial-trends" class="section level1">
<h1 class="hasAnchor">
<a href="#correction-for-spatial-trends" class="anchor"></a>Correction for spatial trends</h1>
<p>Phenotyping facilities display spatial heterogeneity. For example, the spatial variability of incident light can go up to 100% between pots within a greenhouse <span class="citation">(Cabrera-Bosquet et al. 2016)</span>. Taking into account these spatial trends is a prerequisite for precise estimation of genetic and treatment effects. In the same way as in field trials, platform experiments should obey standard principles for experimental design and statistical modeling.</p>
<p>To get corrected values and genotypic predictions we want to accurately separate the genetic effects from the spatial effects at each time point. To do this, for each time point a spatial model is fitted for the trait we are interested in. In <code>statgenHTP</code> spatial models can either be fitted using <em>SpATS</em> <span class="citation">(Rodríguez-Álvarez et al. 2018)</span> and <em>ASReml</em> <span class="citation">(Butler et al. 2017)</span>. This vignette will focus on models fitted using SpATS. For models fitted using ASReml see <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/SpatialModel_HTP.html">this vignette</a>.</p>
<div id="SpATS" class="section level2">
<h2 class="hasAnchor">
<a href="#SpATS" class="anchor"></a>Spatial model using SpATS</h2>
<p>When SpATS is used for modeling, an extra spatial term is included in the model. This spatial component is composed using the <code>PSANOVA</code> function in the SpATS package which uses 2-dimensional smoothing with P-splines as described in <span class="citation">Lee, Durbán, and Eilers (2013)</span> and in <span class="citation">Rodríguez-Álvarez et al. (2018)</span>.</p>
<p>In the example below the model is fitted for a few points.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Fit a model for a few time points.</span>
<span class="va">modPhenoSp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitModels.html">fitModels</a></span><span class="op">(</span>TP <span class="op">=</span> <span class="va">phenoTPOut</span>, 
                        trait <span class="op">=</span> <span class="st">"EffpsII"</span>,
                        timePoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">33</span>, <span class="fl">36</span>, <span class="fl">54</span>, <span class="fl">73</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modPhenoSp</span><span class="op">)</span>
<span class="co">#&gt; Models in modPhenoSp where fitted for experiment Phenovator.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; It contains 5 time points.</span>
<span class="co">#&gt; The models were fitted using SpATS.</span></code></pre></div>
</div>
<div id="model-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#model-plots" class="anchor"></a>Model plots</h2>
<p>Several types of plots can be made for fitted models. A <strong>spatial</strong> plot consists of spatial plots of the raw data, fitted values, residuals and either BLUEs or BLUPs, and a histogram of the BLUEs or BLUPs. When SpATS is used for modeling an extra plot with the fitted spatial trend is included.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>,
     timePoints <span class="op">=</span> <span class="fl">36</span>,
     plotType <span class="op">=</span> <span class="st">"spatial"</span>,
     spaTrend <span class="op">=</span> <span class="st">"percentage"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpatPerc-1.png" width="700.8"></p>
<p>It is also possible to create a time lapse of the ratio of spatial trends over time. The scale is the same as previously described. The time lapse is always written to an output file.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"timeLapse"</span>,
     outFile <span class="op">=</span> <span class="st">"TimeLapse_modPhenoSp.gif"</span><span class="op">)</span></code></pre></div>
<p>In the <strong>rawPred</strong> plot the raw data (colored dots, one color per plotId) is plotted overlaid with the predicted values (black dots) from the fitted model.</p>
<p><em>Note: The model has been fitted on a limited number of time points, which is reflected in the plots. For plots using more time point see <a href="https://biometris.github.io/statgenHTP/articles/vignettesSite/SpatialModel_HTP.html">this vignette</a>.</em></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"rawPred"</span>,
     genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G007"</span>, <span class="st">"G058"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpPred-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In the <strong>corrPred</strong> plot the corrected data (colored dots, one color per plotId) is plotted overlaid with the predicted values (black dots) from the fitted model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"corrPred"</span>,
     genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G007"</span>, <span class="st">"G058"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpCorr-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The last three types of plot display different model parameters over time. Plot type <strong>herit</strong> plots the heritability over time.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"herit"</span>,
     yLim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpHerit-1.png" width="336" style="display: block; margin: auto;"></p>
<p>Plot type <strong>variance</strong> plots the residual, column and row variances over time. These plots can serve as diagnostics of the experiment.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"variance"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpVar-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Plot type <strong>effDim</strong> plots the effective dimension from models fitted using SpATS over time.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modPhenoSp</span>, 
     plotType <span class="op">=</span> <span class="st">"effDim"</span>,
     whichED <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"colId"</span>, <span class="st">"rowId"</span>, <span class="st">"fColRow"</span>,<span class="st">"colfRow"</span>, <span class="st">"surface"</span><span class="op">)</span>,
     EDType <span class="op">=</span> <span class="st">"ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSpED-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="extracting-model-results" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-model-results" class="anchor"></a>Extracting model results</h2>
<p>All results that can be extracted are shown in the table below. The first column contains the function names. The second column contains a short description of the result that will be extracted and, where needed, states for which modeling engines it can be extracted.</p>
<table class="table">
<colgroup>
<col width="17%">
<col width="82%">
</colgroup>
<thead><tr class="header">
<th>FUNCTION</th>
<th>DESCRIPTION</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>getGenoPred</td>
<td>Best Linear Unbiased Predictions (BLUPS, genotype as random) or Estimators (BLUEs, genotype as fixed)</td>
</tr>
<tr class="even">
<td>getCorrected</td>
<td>Spatially corrected values at the experimental unit level</td>
</tr>
<tr class="odd">
<td>getVar</td>
<td>Variance components</td>
</tr>
<tr class="even">
<td>getHerit</td>
<td>Generalized heritabilities - only when genotype is random</td>
</tr>
<tr class="odd">
<td>getEffDims</td>
<td>Effective dimensions - only for SpATS engine</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Extract the genotypic predictions for one time point: </span>
<span class="va">genoPredSp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGenoPred.html">getGenoPred</a></span><span class="op">(</span><span class="va">modPhenoSp</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">genotype</th>
<th align="center">predicted.values</th>
<th align="center">standard.errors</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">check1</td>
<td align="center">0.6708932</td>
<td align="center">0.0050545</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">check2</td>
<td align="center">0.5811530</td>
<td align="center">0.0068930</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">check3</td>
<td align="center">0.6432175</td>
<td align="center">0.0067430</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">check4</td>
<td align="center">0.6808257</td>
<td align="center">0.0049853</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">G001</td>
<td align="center">0.6706490</td>
<td align="center">0.0089158</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">G002</td>
<td align="center">0.6640368</td>
<td align="center">0.0089164</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outlier-detection-for-series-of-observations" class="section level1">
<h1 class="hasAnchor">
<a href="#outlier-detection-for-series-of-observations" class="anchor"></a>Outlier detection for series of observations</h1>
<p>After correcting the data for spatial trends, we can now check if the data contains outliers for series of observations. We do this by modeling each time course using a non-parametric smoothing spline with a fixed number of knots. The estimates for the spline coefficients are then extracted per time course (typically per plant) and correlations between those coefficient vectors are calculated to identify outlying time courses, <em>i.e.</em>, plants.</p>
<p>The function <code><a href="../reference/fitSpline.html">fitSpline()</a></code> fits a P-spline per plant for the selected <code>trait</code>. The function output contains the P-spline model coefficients and the values predicted on a dense grid using the P-spline model coefficients.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">spatCorrectedVator</span><span class="op">)</span>  
<span class="co"># Fit P-splines using on a subset of genotypes.</span>
<span class="va">subGenoVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G160"</span>, <span class="st">"G151"</span><span class="op">)</span>

<span class="va">fit.spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,
                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                        genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,
                        knots <span class="op">=</span> <span class="fl">50</span>,
                        useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,
                        timeNumber <span class="op">=</span> <span class="st">"timeNumHour"</span><span class="op">)</span>
<span class="co"># Extracting the tables of predicted values and P-spline coefficients</span>
<span class="va">predDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">predDat</span>
<span class="va">coefDat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">coefDat</span></code></pre></div>
<p>We can then visualize the P-spline predictions and first derivatives for a subset of genotypes or for a subset of plots.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.spline</span>,
     genotypes <span class="op">=</span> <span class="st">"G160"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotSplGeno-1.png" width="672"></p>
<p>The coefficients are then used to tag suspect time courses with the function <code><a href="../reference/detectSerieOut.html">detectSerieOut()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectSerieOut.html">detectSerieOut</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrectedVator</span>,
                           predDat <span class="op">=</span> <span class="va">predDat</span>,
                           coefDat <span class="op">=</span> <span class="va">coefDat</span>,
                           trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span>,
                           thrCor <span class="op">=</span> <span class="fl">0.9</span>,
                           thrPca <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">plotId</th>
<th align="center">genotype</th>
<th align="center">reason</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">c21r25</td>
<td align="center">G151</td>
<td align="center">mean corr</td>
<td align="center">0.8305035</td>
</tr>
<tr class="even">
<td align="center">c21r25</td>
<td align="center">G151</td>
<td align="center">angle</td>
<td align="center">33.8868907</td>
</tr>
<tr class="odd">
<td align="center">c9r4</td>
<td align="center">G160</td>
<td align="center">mean corr</td>
<td align="center">0.7069584</td>
</tr>
<tr class="even">
<td align="center">c9r4</td>
<td align="center">G160</td>
<td align="center">angle</td>
<td align="center">45.1419532</td>
</tr>
<tr class="odd">
<td align="center">c9r4</td>
<td align="center">G160</td>
<td align="center">slope</td>
<td align="center">0.6432851</td>
</tr>
</tbody>
</table>
<p>Visualizing the results we see that for genotype G151 plant c21r25 is tagged as outlier:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">outVator</span>, genotypes <span class="op">=</span> <span class="st">"G151"</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/plotOutVator-1.png" width="576"></p>
<p>We can then remove the outlying plants from the data set or fitted spline.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.splineOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeSerieOut.html">removeSerieOut</a></span><span class="op">(</span>fitSpline <span class="op">=</span> <span class="va">fit.spline</span>,
                                serieOut <span class="op">=</span> <span class="va">outVator</span><span class="op">)</span></code></pre></div>
</div>
<div id="estimation-of-parameters-from-time-courses" class="section level1">
<h1 class="hasAnchor">
<a href="#estimation-of-parameters-from-time-courses" class="anchor"></a>Estimation of parameters from time courses</h1>
<p>The final step in the HTP data analysis is extracting interesting parameters from the modeled time courses. The parameters can then be further analyzed, for example in a GxE analysis (see <a href="https://biometris.github.io/statgenGxE/index.html"><em>statgenGxE</em></a>), or a genetic analysis (see <a href="https://biometris.github.io/statgenGWAS/index.html"><em>statgenGWAS</em></a>).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subGenoVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G160"</span>, <span class="st">"G151"</span><span class="op">)</span>
<span class="va">paramVator1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>HTPSpline <span class="op">=</span> <span class="va">fit.splineOut</span>,
                           estimate <span class="op">=</span> <span class="st">"predictions"</span>,
                           what <span class="op">=</span> <span class="st">"AUC"</span>,
                           timeMin <span class="op">=</span> <span class="fl">330</span>,
                           timeMax <span class="op">=</span> <span class="fl">432</span>,
                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">paramVator1</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">genotype</span>, y <span class="op">=</span> <span class="va">AUC_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"AUC of EffPsII"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Overview_HTP_files/figure-html/paramVator-1.png" width="384"></p>
<hr>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gilmour2017" class="csl-entry">
Butler, D. G., B. R. Cullis, A. R. Gilmour, B. G. Gogel, and R. Thompson. 2017. <span>“ASReml-r Reference Manual Version 4.”</span> <a href="https://www.vsni.co.uk/">https://www.vsni.co.uk/</a>.
</div>
<div id="ref-Cabrera2016" class="csl-entry">
Cabrera-Bosquet, Llorenç, Christian Fournier, Nicolas Brichet, Claude Welcker, Benoît Suard, and François Tardieu. 2016. <span>“High-Throughput Estimation of Incident Light, Light Interception and Radiation-Use Efficiency of Thousands of Plants in a Phenotyping Platform.”</span> <em>New Phytologist</em> 212 (1): 269–81. <a href="https://doi.org/10.1111/nph.14027">https://doi.org/10.1111/nph.14027</a>.
</div>
<div id="ref-vanEeuw2019" class="csl-entry">
Eeuwijk, Fred A. van, Daniela Bustos-Korts, Emilie J. Millet, Martin P. Boer, Willem Kruijer, Addie Thompson, Marcos Malosetti, et al. 2019. <span>“Modelling Strategies for Assessing and Increasing the Effectiveness of New Phenotyping Techniques in Plant Breeding.”</span> <em>Plant Science</em> 282 (May): 23–39. <a href="https://doi.org/10.1016/j.plantsci.2018.06.018">https://doi.org/10.1016/j.plantsci.2018.06.018</a>.
</div>
<div id="ref-Flood2016" class="csl-entry">
Flood, Pádraic J., Willem Kruijer, Sabine K. Schnabel, Rob van der Schoor, Henk Jalink, Jan F. H. Snel, Jeremy Harbinson, and Mark G. M. Aarts. 2016. <span>“Phenomics for Photosynthesis, Growth and Reflectance in <span>Arabidopsis</span> Thaliana Reveals Circadian and Long-Term Fluctuations in Heritability.”</span> <em>Plant Methods</em> 12 (1): 14. <a href="https://doi.org/10.1186/s13007-016-0113-y">https://doi.org/10.1186/s13007-016-0113-y</a>.
</div>
<div id="ref-Lee2013" class="csl-entry">
Lee, Dae-Jin, María Durbán, and Paul Eilers. 2013. <span>“Efficient Two-Dimensional Smoothing with p-Spline ANOVA Mixed Models and Nested Bases.”</span> <em>Computational Statistics <span>&amp;</span> Data Analysis</em> 61 (May): 22–37. <a href="https://doi.org/10.1016/j.csda.2012.11.013">https://doi.org/10.1016/j.csda.2012.11.013</a>.
</div>
<div id="ref-RodAlv2018" class="csl-entry">
Rodríguez-Álvarez, María, Martin P. Boer, Fred van Eeuwijk, and Paul H. C. Eilers. 2018. <span>“Correcting for Spatial Heterogeneity in Plant Breeding Experiments with p-Splines.”</span> <em>Spatial Statistics</em> 23 (October): 52–71. <a href="https://doi.org/10.1016/j.spasta.2017.10.003">https://doi.org/10.1016/j.spasta.2017.10.003</a>.
</div>
<div id="ref-vanRooi2017" class="csl-entry">
Rooijen, Roxanne van, Willem Kruijer, René Boesten, Fred A. van Eeuwijk, Jeremy Harbinson, and Mark G. M. Aarts. 2017. <span>“Natural Variation of <span>YELLOW</span> <span>SEEDLING</span>1 Affects Photosynthetic Acclimation of <span>Arabidopsis</span> Thaliana.”</span> <em>Nature Communications</em> 8 (1). <a href="https://doi.org/10.1038/s41467-017-01576-3">https://doi.org/10.1038/s41467-017-01576-3</a>.
</div>
<div id="ref-Tardieu2017" class="csl-entry">
Tardieu, François, Llorenç Cabrera-Bosquet, Tony Pridmore, and Malcolm Bennett. 2017. <span>“Plant <span>Phenomics</span>, <span>From</span> <span>Sensors</span> to <span>Knowledge</span>.”</span> <em>Current Biology</em> 27 (15): R770–83. <a href="https://doi.org/10.1016/j.cub.2017.05.055">https://doi.org/10.1016/j.cub.2017.05.055</a>.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
