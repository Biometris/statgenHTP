<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>statgenHTP tutorial: 4. Outlier detection Time courses • statgenHTP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="statgenHTP tutorial: 4. Outlier detection Time courses">
<meta property="og:description" content="statgenHTP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenHTP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenHTP">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="OutliersTimeCourse_HTP_files/header-attrs-2.4/header-attrs.js"></script><script src="OutliersTimeCourse_HTP_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>statgenHTP tutorial: 4. Outlier detection Time courses</h1>
                        <h4 class="author">Emilie Millet, Bart-Jan van Rossum, Isabelle Sanchez, Nadine Hilgert</h4>
            
            <h4 class="date">2020-10-09</h4>
      
      
      <div class="hidden name"><code>OutliersTimeCourse_HTP.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>It consists in detecting outliers in a set of time courses resulting from the observation of one single trait. The detection procedure is applied to each trait individually without considering other traits, meaning that distinct outlier datasets are associated with each considered trait.</p>
<p>The final step consists in extracting interesting parameterd from the modelled time course, for example a maximum rate of growth, or a minimum value in a specific period. These parameters could then be further analysed, for example a GxE analysis (see <em>statgenGxE</em>), or a genetic analysis (see <em>statgenGWAS</em>).</p>
<div id="a-nonparametric-smoothing-associated-with-a-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#a-nonparametric-smoothing-associated-with-a-pca" class="anchor"></a>A nonparametric smoothing associated with a PCA</h2>
<p>Each time course is modelled by a nonparametric smoothing spline with a fixed number of knots. This is a piecewise cubic polynomial (<span class="citation">(Eubank 1999)</span>, <span class="citation">(Eilers, Marx, and Durbán 2015)</span>) fitted with the ‘gam’ function of the R-package ‘mgcv’.</p>
<center>
<div class="figure">
<img src="figures/pspline.png" style="width:40.0%" alt=""><p class="caption">P-spline</p>
</div>
P-spline illustration with 20 knots, from <span class="citation">(Hugelier, Devos, and Ruckebusch 2016)</span>. The individual B-splines (with the correct coefficients) are shown (colored lines), as well as their sum representing the fit (thick black line).
</center>
<p>The estimates for the spline coefficients are then extracted per time course (typically per plant) and correlations between those coefficient vectors are calculated to identify outlying time courses, i.e., plants. An outlying time course will have low correlation to the majority of time courses. To support the analysis by correlations, a principal component analysis can be done on the plant (time course) by spline coefficient matrix. A PCA plot of the plant scores will show the outlying plant.</p>
<p><em>To note,</em> for p-splines in generalized additive model (gam), the smoothing coefficient is optimized by restricted maximum likelihood but the number of knots is chosen by the user.</p>
<p>This document describes the procedure to detect outlying time course with examples on experimental data sets (see <em>Intro_HTP</em>). The data on which the procedures apply are the variables of interest. They may be variables measured directly or indirectly (through image analysis for example). The way they were obtained doesn’t matter. The following functions can be applied to corrected data (see <em>SpatialModel_HTP</em>) or on raw data.</p>
<hr>
</div>
</div>
<div id="illustration-of-the-non-parametric-smoothing-associated-with-a-pca" class="section level1">
<h1 class="hasAnchor">
<a href="#illustration-of-the-non-parametric-smoothing-associated-with-a-pca" class="anchor"></a>Illustration of the non-parametric smoothing associated with a PCA</h1>
<p>The function <code><a href="../reference/fitSpline.html">fitSpline()</a></code> fits a p-spline per plant for the selected <code>trait</code> using the number of <code>knots</code> chosen by the user. In P-spline, the knots are equally spaced and their number can be large. The user should also chose an appropriate proportion of minimum number of time points that should be in the dataset per plant <code>perMinTP</code>. When a plant has less time points than the minimum, it will be skipped from the analysis.</p>
<p>The functions are illustrated with the three example data sets. For more information about the data, see <em>Intro_HTP</em>.</p>
<div id="example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h2>
<p>The data from the Phenovator platform have been corrected for spatial trends and time points outliers have been removed (see <em>XXXXX</em>). At this stage, the cleaned and corrected data are used:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">spatCorrVator</span><span class="op">)</span>  
<span class="co"># Format the timepoint</span>
<span class="va">spatCorrVator</span><span class="op">$</span><span class="va">timePoint</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">spatCorrVator</span><span class="op">$</span><span class="va">timePoint</span><span class="op">)</span>
<span class="co"># Run the function to fit p-spline using the mgcv package on a subset of genotypes</span>
<span class="va">subGeno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G70"</span>,<span class="st">"G160"</span>,<span class="st">"G151"</span>,<span class="st">"G179"</span>,<span class="st">"G175"</span>,<span class="st">"G4"</span>,<span class="st">"G55"</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">fit.spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                        genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                        knots <span class="op">=</span> <span class="fl">50</span>,
                        perMinTP <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="co"># Extracting the tables of predicted values and pspline coeficients</span>
<span class="va">pred.Dat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">predDat</span>
<span class="va">coef.Dat</span> <span class="op">&lt;-</span> <span class="va">fit.spline</span><span class="op">$</span><span class="va">coefDat</span></pre></div>
<p>The object <code>fit.spline</code> contains the predicted value (<code>pred.value</code> in the table below), i.e the values predicted using the P-spline model coefficients. Conversion to numerical time is required by the mgcv package. In order to keep the same time scale as in the original <code>timePoint</code> column, a simple numerical transformation of the time points is made (column <code>timeNumber</code>). Predictions are made on a denser grid of time points: the time points for prediction are calculated as the smallest gap between two time points divided by 9, so dividing the smallest gap in 10 segments. The object <code>fit.spline</code> also contains the first derivatives (<code>deriv</code> <strong>see part XXX about Parameters estimation</strong>).</p>
<table class="table">
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pred.value</th>
<th align="center">deriv</th>
<th align="center">plotId</th>
<th align="center">genotype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1527784620</td>
<td align="center">2018-05-31 16:37:00</td>
<td align="center">0.6699615</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="center">1527785420</td>
<td align="center">2018-05-31 16:50:20</td>
<td align="center">0.6691239</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
<tr class="odd">
<td align="center">1527786220</td>
<td align="center">2018-05-31 17:03:40</td>
<td align="center">0.6682884</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="center">1527787020</td>
<td align="center">2018-05-31 17:17:00</td>
<td align="center">0.6674552</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
<tr class="odd">
<td align="center">1527787820</td>
<td align="center">2018-05-31 17:30:20</td>
<td align="center">0.6666245</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="center">1527788620</td>
<td align="center">2018-05-31 17:43:40</td>
<td align="center">0.6657966</td>
<td align="center">-1e-06</td>
<td align="center">c10r29</td>
<td align="center">G160</td>
</tr>
</tbody>
</table>
<p>The numerical time can be provided by the user, for example when using thermal time or a manual conversion. In this example, we provide a new column with time in hour since first measurement.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">fit.splineNum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                           trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                           genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                           knots <span class="op">=</span> <span class="fl">50</span>,
                           perMinTP <span class="op">=</span> <span class="fl">0.8</span>,
                           useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,
                           timeNumber <span class="op">=</span> <span class="st">"timeNumHour"</span><span class="op">)</span></pre></div>
<p>We can then visualise the p-spline predictions and first derivatives for a subset of genotypes or for a subset of plots.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.spline</span>,
     genotypes <span class="op">=</span> <span class="st">"G160"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotSplGeno-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.spline</span>,
     plotIds <span class="op">=</span> <span class="st">"c10r29"</span>,
     plotType <span class="op">=</span>  <span class="st">"predictions"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotSplPlot-1.png" width="384"></p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.spline</span>,
     plotIds <span class="op">=</span> <span class="st">"c10r29"</span>,
     plotType <span class="op">=</span>  <span class="st">"derivatives"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotSplPlot-2.png" width="384"></p>
<p>The object <code>fit.spline</code> also contains the values of the P-splines coefficients:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="center">obj.coefficients</th>
<th align="center">plotId</th>
<th align="center">type</th>
<th align="center">genotype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="center">0.6174143</td>
<td align="center">c10r29</td>
<td align="center">Intercept</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="left">s(timeNumber).1</td>
<td align="center">0.0484384</td>
<td align="center">c10r29</td>
<td align="center">stimeNumber.1</td>
<td align="center">G160</td>
</tr>
<tr class="odd">
<td align="left">s(timeNumber).2</td>
<td align="center">0.0153285</td>
<td align="center">c10r29</td>
<td align="center">stimeNumber.2</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="left">s(timeNumber).3</td>
<td align="center">-0.0139713</td>
<td align="center">c10r29</td>
<td align="center">stimeNumber.3</td>
<td align="center">G160</td>
</tr>
<tr class="odd">
<td align="left">s(timeNumber).4</td>
<td align="center">-0.0022154</td>
<td align="center">c10r29</td>
<td align="center">stimeNumber.4</td>
<td align="center">G160</td>
</tr>
<tr class="even">
<td align="left">s(timeNumber).5</td>
<td align="center">0.0197600</td>
<td align="center">c10r29</td>
<td align="center">stimeNumber.5</td>
<td align="center">G160</td>
</tr>
</tbody>
</table>
<p>The coefficients are then used to tag suspect time courses with the function <code>detectOutliers()</code>. This function performs a PCA on the coefficients (from data frame <code>coef.Dat</code>) per <code>genotype</code> and tags the plants that have a coordinate on the second PC axis above a threshold (<code>thrPca</code>), see the lines ‘reason = pc2’ in the table below. The function also calculates the pairwise-correlation of the coefficients per genotype. Plants are tagged when the correlation is below a given threshold (<code>thrCor</code>), see the lines <code>reason = mean corr</code> in the table below.</p>
<p>For obvious reasons, the detection will only work when there are at least three replicates per genotype. Genotypes with less than three replicates will be skipped. (TRUE?)</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">outVator</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/detectTimeCourseOutliers.html">detectTimeCourseOutliers</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                           predDat <span class="op">=</span> <span class="va">pred.Dat</span>,
                           coefDat <span class="op">=</span> <span class="va">coef.Dat</span>,
                           trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                           genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                           thrCor <span class="op">=</span> <span class="fl">0.9</span>,
                           thrPca <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">plotId</th>
<th align="center">genotype</th>
<th align="center">reason</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">c21r25</td>
<td align="center">G151</td>
<td align="center">mean corr</td>
<td align="center">0.8315769</td>
</tr>
<tr class="even">
<td align="center">c21r25</td>
<td align="center">G151</td>
<td align="center">pc2</td>
<td align="center">1.0636029</td>
</tr>
<tr class="odd">
<td align="center">c9r4</td>
<td align="center">G160</td>
<td align="center">mean corr</td>
<td align="center">0.6907644</td>
</tr>
<tr class="even">
<td align="center">c9r4</td>
<td align="center">G160</td>
<td align="center">pc2</td>
<td align="center">1.0726651</td>
</tr>
<tr class="odd">
<td align="center">c11r55</td>
<td align="center">G4</td>
<td align="center">pc2</td>
<td align="center">1.0605128</td>
</tr>
<tr class="even">
<td align="center">c4r13</td>
<td align="center">G70</td>
<td align="center">pc2</td>
<td align="center">1.0853397</td>
</tr>
</tbody>
</table>
<p>For this subset of genotypes, 4 plants were tagged as outliers:</p>
<ul>
<li>c21r25 and c9r4 had both low correlations and extreme PC axis coordinates,<br>
</li>
<li>c11r55 and c4r13 had extreme PC axis coordinates.</li>
</ul>
<p>The <code>outVator</code> can be visualised by selecting genotypes. Here genotype G151 which has plant c21r25 tagged as outlier:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">outVator</span>, genotypes <span class="op">=</span> <span class="st">"G151"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotOutVator-1.png" width="576"></p>
<p>The figure above contains:</p>
<ul>
<li>(top) A scatter plot of the trait value in y axis and time in x axis. Points are the raw or corrected data and lines are the p-spline predictions, with one color per plant (in legend).<br>
</li>
<li>(bottom left) A correlation matrix of the plant scores as a heatmap. The scale is centered on 0.9 to see at a glance the outlying plants with low correlations (usually correlation are high between plants).<br>
</li>
<li>(bottom right) A PCA plot of the plant scores. Usually, all plants are grouped and the first axis explained most of the variation. When a plant is outlying, it will be located apart from the other plants on the second axis.</li>
</ul>
<p>Finally, the outlying plants can be removed from the dataset…</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">spatCorrVatorOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeTimeCourseOutliers.html">removeTimeCourseOutliers</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                                            timeCourseOutliers <span class="op">=</span> <span class="va">outVator</span><span class="op">)</span>
<span class="co"># Check one value annotated as outlier in the original corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">spatCorrVator</span><span class="op">[</span><span class="va">spatCorrVator</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"c21r25"</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EffpsII_corr"</span>,<span class="st">"EffpsII"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       EffpsII_corr EffpsII</span>
<span class="co">#&gt; 1814     0.6928991   0.694</span>
<span class="co">#&gt; 4615     0.4700974   0.464</span>
<span class="co">#&gt; 10266    0.8133518   0.819</span>
<span class="co">#&gt; 11683    0.7531879   0.749</span>
<span class="co">#&gt; 14524    0.5637728   0.563</span>
<span class="co">#&gt; 15949           NA      NA</span>
<span class="co"># Check the same value in the new corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">spatCorrVatorOut</span><span class="op">[</span><span class="va">spatCorrVatorOut</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"c21r25"</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EffpsII_corr"</span>,<span class="st">"EffpsII"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       EffpsII_corr EffpsII</span>
<span class="co">#&gt; 1814            NA   0.694</span>
<span class="co">#&gt; 4615            NA   0.464</span>
<span class="co">#&gt; 10266           NA   0.819</span>
<span class="co">#&gt; 11683           NA   0.749</span>
<span class="co">#&gt; 14524           NA   0.563</span>
<span class="co">#&gt; 15949           NA      NA</span></pre></div>
<p>… and from the predictions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">fit.splineOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeTimeCourseOutliers.html">removeTimeCourseOutliers</a></span><span class="op">(</span>fitSpline <span class="op">=</span> <span class="va">fit.spline</span>,
                                          timeCourseOutliers <span class="op">=</span> <span class="va">outVator</span><span class="op">)</span>
<span class="va">fit.splineNumOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeTimeCourseOutliers.html">removeTimeCourseOutliers</a></span><span class="op">(</span>fitSpline <span class="op">=</span> <span class="va">fit.splineNum</span>,
                                             timeCourseOutliers <span class="op">=</span> <span class="va">outVator</span><span class="op">)</span></pre></div>
<div id="impact-of-the-number-of-knots-on-the-smoothing" class="section level3">
<h3 class="hasAnchor">
<a href="#impact-of-the-number-of-knots-on-the-smoothing" class="anchor"></a>Impact of the number of knots on the smoothing</h3>
<p>For one plant of the example 1, we fit the p-spline with 10 or 50 knots and visualize the predictions to compare the smoothness. We advise the user to perform tests of the number of knots on a subset of plants before running the function on all plants.</p>
<p><em>With 10 knots:</em></p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">sp10k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                        plotIds <span class="op">=</span> <span class="st">"c10r29"</span>,
                        knots <span class="op">=</span> <span class="fl">10</span>,
                        perMinTP <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sp10k</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/fitSplineVatorKnots10-1.png" width="384"></p>
<p>The predicted curve is very smooth and, in this case, it is not following precisely the real data curve shape. When comparing the plants of a same genotype with this curve shape we might not identify the outlying plant.</p>
<p><em>With 50 knots:</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">sp50k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrVator</span>,
                        trait <span class="op">=</span> <span class="st">"EffpsII_corr"</span>,
                        plotIds <span class="op">=</span> <span class="st">"c10r29"</span>,
                        knots <span class="op">=</span> <span class="fl">50</span>,
                        perMinTP <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sp50k</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/fitSplineVatorKnots50-1.png" width="384"></p>
<p>The predicted curve is less smooth and follows the actual curve shape. This seems to be a good setting to detect strange curve shape among the replicates of a genotype.</p>
</div>
</div>
<div id="example-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h2>
<p>The data from the PhenoArch platform have been corrected for spatial trends and time points outliers have been removed (see <em>XXXXX</em>). At this stage, the cleaned and corrected data are used:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">spatCorrArch</span><span class="op">)</span>  
<span class="va">spatCorrArch</span><span class="op">$</span><span class="va">timePoint</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">spatCorrArch</span><span class="op">$</span><span class="va">timePoint</span><span class="op">)</span>
<span class="va">subGeno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GenoA1"</span>,<span class="st">"GenoA2"</span>,<span class="st">"GenoA3"</span>,<span class="st">"GenoA4"</span>,<span class="st">"GenoB1"</span>,<span class="st">"GenoB2"</span>,<span class="st">"GenoB3"</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">fit.splineArch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrArch</span>, 
                            trait <span class="op">=</span> <span class="st">"Biomass_Estimated_corr"</span>,
                            genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                            knots <span class="op">=</span> <span class="fl">15</span>,
                            perMinTP <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">pred.DatArch</span> <span class="op">&lt;-</span> <span class="va">fit.splineArch</span><span class="op">$</span><span class="va">predDat</span>
<span class="va">coef.DatArch</span> <span class="op">&lt;-</span> <span class="va">fit.splineArch</span><span class="op">$</span><span class="va">coefDat</span></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.splineArch</span>,
     plotIds <span class="op">=</span> <span class="st">"c11r9"</span>,
     plotType <span class="op">=</span>  <span class="st">"predictions"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotArch-1.png" width="384"></p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.splineArch</span>,
     plotIds <span class="op">=</span> <span class="st">"c11r9"</span>,
     plotType <span class="op">=</span>  <span class="st">"derivatives"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotArch-2.png" width="384"></p>
<p>Here, the <code>geno.decomp</code> option is also used to split the plants of each genotypes between well watered and drought. The outliers detection is run per treatment.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">outArch</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/detectTimeCourseOutliers.html">detectTimeCourseOutliers</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">spatCorrArch</span>,
                           predDat <span class="op">=</span> <span class="va">pred.DatArch</span>,
                           coefDat <span class="op">=</span> <span class="va">coef.DatArch</span>,
                           trait <span class="op">=</span> <span class="st">"Biomass_Estimated_corr"</span>,
                           genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                           thrCor <span class="op">=</span> <span class="fl">0.9</span>,
                           thrPca <span class="op">=</span> <span class="fl">1</span>,
                           geno.decomp <span class="op">=</span> <span class="st">"geno.decomp"</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">plotId</th>
<th align="center">genotype</th>
<th align="center">geno.decomp</th>
<th align="center">reason</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">c17r40</td>
<td align="center">GenoB2</td>
<td align="center">WD_Panel2</td>
<td align="center">pc2</td>
<td align="center">1.072931</td>
</tr>
<tr class="even">
<td align="center">c7r55</td>
<td align="center">GenoB3</td>
<td align="center">WW_Panel2</td>
<td align="center">pc2</td>
<td align="center">1.086501</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">outArch</span>, genotypes <span class="op">=</span> <span class="st">"GenoB3"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotOutArch-1.png" width="576"><img src="OutliersTimeCourse_HTP_files/figure-html/plotOutArch-2.png" width="576"></p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">spatCorrArchOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeTimeCourseOutliers.html">removeTimeCourseOutliers</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">spatCorrArch</span>,
                                            timeCourseOutliers <span class="op">=</span> <span class="va">outArch</span><span class="op">)</span>
<span class="co"># Check one value annotated as outlier in the original corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">spatCorrArch</span><span class="op">[</span><span class="va">spatCorrArch</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"c17r40"</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Biomass_Estimated_corr"</span>,<span class="st">"Biomass_Estimated"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       Biomass_Estimated_corr Biomass_Estimated</span>
<span class="co">#&gt; 928                       NA                NA</span>
<span class="co">#&gt; 2598                      NA                NA</span>
<span class="co">#&gt; 5387                1.434445         0.1179894</span>
<span class="co">#&gt; 7813               13.268594         7.7470329</span>
<span class="co">#&gt; 9452               18.149580        12.4334778</span>
<span class="co">#&gt; 10856              22.729554        14.2451385</span>
<span class="co"># Check the same value in the new corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">spatCorrArchOut</span><span class="op">[</span><span class="va">spatCorrArchOut</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"c17r40"</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Biomass_Estimated_corr"</span>,<span class="st">"Biomass_Estimated"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       Biomass_Estimated_corr Biomass_Estimated</span>
<span class="co">#&gt; 928                       NA                NA</span>
<span class="co">#&gt; 2598                      NA                NA</span>
<span class="co">#&gt; 5387                      NA         0.1179894</span>
<span class="co">#&gt; 7813                      NA         7.7470329</span>
<span class="co">#&gt; 9452                      NA        12.4334778</span>
<span class="co">#&gt; 10856                     NA        14.2451385</span></pre></div>
</div>
<div id="example-3" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example 3</h2>
<p>The data from the RootPhAir platform have not been corrected for spatial trends but time points outliers have been removed (see <em>XXXXX</em>). At this stage, the cleaned data are used:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">noCorrRoot</span><span class="op">$</span><span class="va">timePoint</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">noCorrRoot</span><span class="op">$</span><span class="va">timePoint</span><span class="op">)</span>
<span class="va">subGeno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"2"</span>,<span class="st">"6"</span>,<span class="st">"8"</span>,<span class="st">"9"</span>,<span class="st">"10"</span>,<span class="st">"520"</span>,<span class="st">"522"</span><span class="op">)</span>
<span class="va">fit.splineRoot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">noCorrRoot</span>,
                            trait <span class="op">=</span> <span class="st">"tipPos_y"</span>,
                            knots <span class="op">=</span> <span class="fl">10</span>,
                            genotypes <span class="op">=</span> <span class="va">subGeno</span>,
                            perMinTP <span class="op">=</span> <span class="fl">0.001</span>,
                            useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,
                            timeNumber <span class="op">=</span> <span class="st">"thermalTime"</span><span class="op">)</span>

<span class="va">pred.DatRoot</span> <span class="op">&lt;-</span> <span class="va">fit.splineRoot</span><span class="op">$</span><span class="va">predDat</span>
<span class="va">coef.DatRoot</span> <span class="op">&lt;-</span> <span class="va">fit.splineRoot</span><span class="op">$</span><span class="va">coefDat</span>
<span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">coef.DatRoot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coef.DatRoot</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit.splineRoot</span>,
     genotypes <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotRoot-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">outRoot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectTimeCourseOutliers.html">detectTimeCourseOutliers</a></span><span class="op">(</span>corrDat <span class="op">=</span> <span class="va">noCorrRoot</span>,
                                    predDat <span class="op">=</span> <span class="va">pred.DatRoot</span>,
                                    coefDat <span class="op">=</span> <span class="va">coef.DatRoot</span>,
                                    trait <span class="op">=</span> <span class="st">"tipPos_y"</span>,
                                    genotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">subGeno</span><span class="op">)</span>,
                                    thrCor <span class="op">=</span> <span class="fl">0.9</span>,
                                    thrPca <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">outRoot</span>,
     genotypes <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/plotRootOut-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">noCorrRootOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeTimeCourseOutliers.html">removeTimeCourseOutliers</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">noCorrRoot</span>,
                                            timeCourseOutliers <span class="op">=</span> <span class="va">outRoot</span><span class="op">)</span>
<span class="co"># Check one value annotated as outlier in the original corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">noCorrRoot</span><span class="op">[</span><span class="va">noCorrRoot</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"A_53_4"</span>,<span class="st">"tipPos_y"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.357143 2.442857 2.578571 2.728571 3.500000 3.685714</span>
<span class="co"># Check the same value in the new corrected data frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">noCorrRootOut</span><span class="op">[</span><span class="va">noCorrRootOut</span><span class="op">$</span><span class="va">plotId</span><span class="op">==</span><span class="st">"A_53_4"</span>,<span class="st">"tipPos_y"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] NA NA NA NA NA NA</span></pre></div>
</div>
</div>
<div id="extraction-parameters-from-curve" class="section level1">
<h1 class="hasAnchor">
<a href="#extraction-parameters-from-curve" class="anchor"></a>Extraction parameters from curve</h1>
<p>After all the steps of cleaning and modeling… blablabla extract parameters from the curve that are relevant for biology. Some examples are provided below for the Phenovator data set (example 1).</p>
<div id="example-1-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-1" class="anchor"></a>Example 1</h2>
<p>We will use the <code>fit.splineNumOut</code> previously created which contains the p-spline prediction without the time course outliers. We could estimate the maximum value of the trait at the beginning of the time course:</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="va">subGeno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G70"</span>,<span class="st">"G160"</span>,<span class="st">"G151"</span>,<span class="st">"G179"</span>,<span class="st">"G175"</span>,<span class="st">"G4"</span>,<span class="st">"G55"</span><span class="op">)</span>
<span class="va">paramVator1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>HTPSpline <span class="op">=</span> <span class="va">fit.splineNumOut</span>,
                           estimate <span class="op">=</span> <span class="st">"predictions"</span>,
                           what <span class="op">=</span> <span class="st">"max"</span>,
                           timeMin <span class="op">=</span> <span class="fl">330</span>,
                           timeMax <span class="op">=</span> <span class="fl">432</span>,
                           genotypes <span class="op">=</span> <span class="va">subGeno</span><span class="op">)</span>
<span class="co">#</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">paramVator1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">genotype</span>, y <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/paramVator-1.png" width="384"></p>
<p>For this subset of genotypes, there is a variability in the maximum values of the psII efficiency after the light treatment. This could be used in genetic analysis and maybe to perform a GWAS.</p>
<p>Another example is using the derivative during the recovery period to get the maximum slope, or the maximum rate of the psII per time unit during this period.</p>
<center>
<img src="figures/psplinederiv.png" title="fig:" style="width:80.0%" alt="P-spline">
</center>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="va">paramVator2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>HTPSpline <span class="op">=</span> <span class="va">fit.splineNumOut</span>,
                           estimate <span class="op">=</span> <span class="st">"derivatives"</span>,
                           what <span class="op">=</span> <span class="st">"max"</span>,
                           timeMin <span class="op">=</span> <span class="fl">210</span>,
                           timeMax <span class="op">=</span> <span class="fl">312</span>,
                           genotypes <span class="op">=</span> <span class="va">subGeno</span><span class="op">)</span>
<span class="co">#</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">paramVator2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">genotype</span>, y <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="OutliersTimeCourse_HTP_files/figure-html/paramVator2-1.png" width="384"></p>
<hr>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-Eilers2015">
<p>Eilers, Paul H. C., Brian D. Marx, and Maria Durbán. 2015. “Twenty Years of P-Splines.” <em>Statistics and Operations Research Transactions</em> 39 (2): 149–86.</p>
</div>
<div id="ref-Eubank1999">
<p>Eubank, Randall L. 1999. <em>Nonparametric Regression and Spline Smoothing</em>. Statistics: A Series of Textbooks and Monographs. CRC Press.</p>
</div>
<div id="ref-Hugelier2016">
<p>Hugelier, S., O. Devos, and C. Ruckebusch. 2016. “Chapter 14 - a Smoothness Constraint in Multivariate Curve Resolution-Alternating Least Squares of Spectroscopy Data.” In <em>Resolving Spectral Mixtures</em>, edited by Cyril Ruckebusch, 30:453–76. Data Handling in Science and Technology. Elsevier. <a href="https://doi.org/https://doi.org/10.1016/B978-0-444-63638-6.00014-0">https://doi.org/https://doi.org/10.1016/B978-0-444-63638-6.00014-0</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
