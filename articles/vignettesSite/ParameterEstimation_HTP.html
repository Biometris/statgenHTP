<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>statgenHTP tutorial: 6. Estimation of parameters from time courses • statgenHTP</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="statgenHTP tutorial: 6. Estimation of parameters from time courses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../index.html" aria-label="home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../../articles/index.html">Vignettes</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>statgenHTP tutorial: 6. Estimation of parameters from time courses</h1>
                        <h4 data-toc-skip class="author">Emilie Millet,
Bart-Jan van Rossum, Martin Boer, Fred van Eeuwijk, Diana M.
Pérez-Valencia, María Xosé Rodríguez-Álvarez</h4>
            
            <h4 data-toc-skip class="date">2025-07-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/vignettes/vignettesSite/ParameterEstimation_HTP.Rmd" class="external-link"><code>vignettes/vignettesSite/ParameterEstimation_HTP.Rmd</code></a></small>
      <div class="d-none name"><code>ParameterEstimation_HTP.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document presents the final step of the HTP data analysis:
extracting interesting parameters from the modeled time courses <span class="citation">(<a href="#ref-Brien2020">Brien et al.
2020</a>)</span>. For example, in the second data set from the PhenoArch
platform, the maximum leaf area (from the P-splines) or the maximum leaf
growth rate (from the first derivatives) are relevant parameters (see
figure below). We could assess their variability in the genotypes and
the difference between treatments, <em>e.g.</em> has the water scenario
decreased the maximum leaf area?</p>
<p><img src="figures/psplinederiv_Arch.png" width="80%"></p>
<p>It is also possible to specify a period for the parameter estimation.
For example, in the first data set from the Phenovator platform, we can
select the period with the high light intensity (see figure below) and
estimate the maximum slope during that period (from the first
derivatives). This could be interpreted as a recovery rate of the
photosystem II efficiency.</p>
<p><img src="figures/psplinederiv_Vator.png" width="80%"></p>
<p>These parameters could then be further analyzed, for example in a GxE
analysis (see <a href="https://biometris.github.io/statgenGxE/index.html" class="external-link"><em>statgenGxE</em></a>),
or a genetic analysis (see <a href="https://biometris.github.io/statgenGWAS/index.html" class="external-link"><em>statgenGWAS</em></a>).</p>
<p>The functions described in this tutorial can be applied to corrected
data, genotypic means (BLUEs or BLUPS) (see <a href="SpatialModel_HTP.html"><strong>statgenHTP tutorial: 3. Correction
for spatial trends</strong></a>), curves obtained from the P-splines
hierarchical data model (see <a href="HierarchicalDataModel_HTP.html"><strong>statgenHTP tutorial: 5.
Modelling the temporal evolution of the genetic signal</strong></a>), or
on raw data. It allows estimating maximum, minimum, mean, area under the
curve (auc) or percentile using predicted values, first or second
derivative, during a given period or for the whole time course.</p>
<hr>
</div>
<div class="section level2">
<h2 id="estimation-of-parameters-from-curves">Estimation of parameters from curves<a class="anchor" aria-label="anchor" href="#estimation-of-parameters-from-curves"></a>
</h2>
<div class="section level3">
<h3 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>We will use the <code>fit.splineNumOut</code> previously created (see
<a href="OutlierSerieObs_HTP.html"><strong>statgenHTP tutorial: 4.
Outlier detection for series of observations</strong></a>). It contains
the P-spline prediction on a subset of plants without the time course
outliers. We will estimate the area under the curve of the trait. Note
that <strong>timeMin</strong> and <strong>timeMax</strong> should be
specified at the time scale used when fitting the spline, in this case
the time number scale.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subGenoVator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G070"</span>, <span class="st">"G160"</span>, <span class="st">"G151"</span>, <span class="st">"G179"</span>, <span class="st">"G175"</span>, <span class="st">"G004"</span>, <span class="st">"G055"</span><span class="op">)</span></span>
<span><span class="va">paramVator1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit.splineNumOut</span>,</span>
<span>                           estimate <span class="op">=</span> <span class="st">"predictions"</span>,</span>
<span>                           what <span class="op">=</span> <span class="st">"AUC"</span>,</span>
<span>                           timeMin <span class="op">=</span> <span class="fl">330</span>,</span>
<span>                           timeMax <span class="op">=</span> <span class="fl">432</span>,</span>
<span>                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramVator1</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramVator-1.png" width="384"></p>
<p>For this subset of genotypes, there is a variability in AUC of the
psII efficiency. This could be used in genetic analysis and maybe to
perform a GWAS.</p>
<p>Another example is using the derivative during the recovery period
(at the end of the time course, so after the light change) to get the
maximum slope, or the maximum rate of the psII per time unit during this
period.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paramVator2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit.splineNumOut</span>,</span>
<span>                           estimate <span class="op">=</span> <span class="st">"derivatives"</span>,</span>
<span>                           what <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>                           timeMin <span class="op">=</span> <span class="fl">210</span>,</span>
<span>                           timeMax <span class="op">=</span> <span class="fl">312</span>,</span>
<span>                           genotypes <span class="op">=</span> <span class="va">subGenoVator</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramVator2</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramVator2-1.png" width="384"></p>
<blockquote>
<p>Note: when “min” or “max” is selected, the output also contains the
parameter occurence time point, as numerical <code>timeNumber</code> and
date <code>timePoint</code>. See in the table below:</p>
</blockquote>
<table class="table">
<colgroup>
<col width="13%">
<col width="11%">
<col width="23%">
<col width="22%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th align="center">genotype</th>
<th align="center">plotId</th>
<th align="center">max_derivatives</th>
<th align="center">max_timeNumber</th>
<th align="center">max_timePoint</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">G004</td>
<td align="center">c11r55</td>
<td align="center">0.0067723</td>
<td align="center">227.7778</td>
<td align="center">2018-06-10 04:23:40</td>
</tr>
<tr class="even">
<td align="center">G004</td>
<td align="center">c13r20</td>
<td align="center">0.0084969</td>
<td align="center">226.0000</td>
<td align="center">2018-06-10 02:37:00</td>
</tr>
<tr class="odd">
<td align="center">G004</td>
<td align="center">c19r15</td>
<td align="center">0.0073183</td>
<td align="center">232.0000</td>
<td align="center">2018-06-10 08:37:00</td>
</tr>
<tr class="even">
<td align="center">G004</td>
<td align="center">c21r45</td>
<td align="center">0.0091547</td>
<td align="center">223.3333</td>
<td align="center">2018-06-09 23:57:00</td>
</tr>
<tr class="odd">
<td align="center">G004</td>
<td align="center">c24r48</td>
<td align="center">0.0080870</td>
<td align="center">224.2222</td>
<td align="center">2018-06-10 00:50:20</td>
</tr>
<tr class="even">
<td align="center">G004</td>
<td align="center">c2r15</td>
<td align="center">0.0079295</td>
<td align="center">226.0000</td>
<td align="center">2018-06-10 02:37:00</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>For this example, we will use the genotypic prediction (BLUPs, see <a href="SpatialModel_HTP.html"><strong>statgenHTP tutorial: 3. Correction
for spatial trends</strong></a>) available in the
<code>spatPredArch</code> data set. We will fit P-splines at the
genotypic level using the <code>geno.decomp</code> levels defined in the
spatial model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spatPredArch</span><span class="op">)</span>  </span>
<span><span class="va">fit.splineGenoArch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatPredArch</span>, </span>
<span>                                trait <span class="op">=</span> <span class="st">"predicted.values"</span>,</span>
<span>                                knots <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                                minNoTP <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit.splineGenoArch</span>, </span>
<span>     genotypes <span class="op">=</span> <span class="st">"GenoA36"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/fitSplineArch-1.png" width="576"></p>
<p>We can estimate the maximum value of the leaf area from the predicted
P-splines:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paramArch1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit.splineGenoArch</span>,</span>
<span>                           estimate <span class="op">=</span> <span class="st">"predictions"</span>,</span>
<span>                           what <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramArch1</span>, plotType <span class="op">=</span> <span class="st">"hist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramArch1fig-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h3>
<p>For this example, we will use curves obtained from the P-splines
hierarchical data model (see <a href="HierarchicalDataModel_HTP.html"><strong>statgenHTP tutorial: 5.
Modelling the temporal evolution of the genetic signal</strong></a>). We
can use <code>psHDM</code> objects (that is, objects obtained from
<code><a href="../../reference/fitSplineHDM.html">fitSplineHDM()</a></code> (fitted curves) or
<code><a href="../../reference/predict.psHDM.html">predict.psHDM()</a></code> (predicted curves)). For this example, we
will use predicted curves.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The data from the Phenovator platform have been corrected for spatial</span></span>
<span><span class="co">## trends and outliers for single observations have been removed.</span></span>
<span></span>
<span><span class="co">## We need to specify the genotype-by-treatment interaction.</span></span>
<span><span class="co">## Treatment: water regime (WW, WD).</span></span>
<span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"geno.decomp"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                      start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genoTreat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genotype"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Fit P-Splines Hierarchical Curve Data Model for all genotypes.</span></span>
<span><span class="va">fit.psHDM</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitSplineHDM.html">fitSplineHDM</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedArch</span>,</span>
<span>                           trait <span class="op">=</span> <span class="st">"LeafArea_corr"</span>,</span>
<span>                           pop <span class="op">=</span> <span class="st">"geno.decomp"</span>,</span>
<span>                           genotype <span class="op">=</span> <span class="st">"genoTreat"</span>,</span>
<span>                           plotId <span class="op">=</span> <span class="st">"plotId"</span>,</span>
<span>                           difVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                           smoothPop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">5</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothGeno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">5</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothPlot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">5</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           weights <span class="op">=</span> <span class="st">"wt"</span>,</span>
<span>                           trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           useTimeNumber <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Predict the P-Splines Hierarchical Curve Data Model on a dense grid</span></span>
<span><span class="co">## Only predictions (and standard errors) are obtained  </span></span>
<span><span class="co">## at the population and genotype levels</span></span>
<span><span class="va">pred.psHDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit.psHDM</span>,</span>
<span>                      newtimes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                     length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                      pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                      se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                      trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Although we have available information at population, genotype and
plot levels, this function only extracts information at genotype and
plot levels. Nevertheless, we are generally interested in the genotype
level. For example, in the paper by <span class="citation">Pérez-Valencia et al. (<a href="#ref-Perez2022">2022</a>)</span>, they extracted three
features:</p>
<ul>
<li>The maximum spatially corrected leaf area (from estimated
genotype-specific trajectories)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##  From estimated genotype-specific trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"popGenoTra"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoPred1-1.png" width="384"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimate maximum spatially corrected leaf area.</span></span>
<span><span class="va">paramArch1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred.psHDM</span>,</span>
<span>                                     what <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>                                     fitLevel <span class="op">=</span> <span class="st">"geno"</span>,</span>
<span>                                     estimate <span class="op">=</span> <span class="st">"predictions"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create a boxplot of the estimates.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramArch1</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoPred2-1.png" width="384"></p>
<ul>
<li>The maximum speed rate (from the first derivative of the estimated
genotype-specific trajectories)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## From the first derivative of the estimated genotype-specific trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"popGenoDeriv"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoDeriv1-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimate maximum speed rate </span></span>
<span><span class="co">## We are interested on a local maximum (before timeNumber 2500)</span></span>
<span><span class="va">paramArch2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred.psHDM</span>,</span>
<span>                                     what <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>                                     fitLevel <span class="op">=</span> <span class="st">"geno"</span>,</span>
<span>                                     estimate <span class="op">=</span> <span class="st">"derivatives"</span>,</span>
<span>                                     timeMax <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create a boxplot of the estimates.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramArch2</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoDeriv2-1.png" width="384"></p>
<ul>
<li>The area under the estimated genotype-specific deviations, as
follows</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## From the estimated genotype-specific deviations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"genoDev"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoDev1-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimate area under the curve (AUC).</span></span>
<span><span class="va">paramArch3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred.psHDM</span>,</span>
<span>                                     what <span class="op">=</span> <span class="st">"AUC"</span>,</span>
<span>                                     fitLevel <span class="op">=</span> <span class="st">"genoDev"</span>,</span>
<span>                                     estimate <span class="op">=</span> <span class="st">"predictions"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create a boxplot of the estimates.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramArch3</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramPhenoGenoDev2-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="example-4">Example 4<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h3>
<p>For this example, we will use the raw data from the RootPhAir,
corrected for individually outlying observations (see <a href="OutlierSingleObs_HTP.html"><strong>statgenHTP tutorial: 2. Outlier
detection for single observations</strong></a>) and time course outliers
(see <a href="OutlierSerieObs_HTP.html"><strong>statgenHTP tutorial: 4.
Outlier detection Time course</strong></a>). We will fit P-splines at
the plant level on a subset of genotypes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subGenoRoot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"2"</span>,<span class="st">"6"</span>,<span class="st">"8"</span>,<span class="st">"9"</span>,<span class="st">"10"</span>,<span class="st">"520"</span>,<span class="st">"522"</span><span class="op">)</span></span>
<span><span class="va">fit.splineRootOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitSpline.html">fitSpline</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">noCorrectedRootOut</span>,</span>
<span>                               trait <span class="op">=</span> <span class="st">"tipPos_y"</span>,</span>
<span>                               knots <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                               genotypes <span class="op">=</span> <span class="va">subGenoRoot</span>,</span>
<span>                               minNoTP <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                               useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               timeNumber <span class="op">=</span> <span class="st">"thermalTime"</span><span class="op">)</span></span></code></pre></div>
<p>We will then estimate the mean growth rate using
<code>what = "mean"</code> for the subset of genotypes:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paramRoot1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../../reference/estimateSplineParameters.html">estimateSplineParameters</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit.splineRootOut</span>,</span>
<span>                           estimate <span class="op">=</span> <span class="st">"derivatives"</span>,</span>
<span>                           what <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paramRoot1</span>, plotType <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ParameterEstimation_HTP_files/figure-html/paramRoot1-1.png" width="384"></p>
<hr>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Brien2020" class="csl-entry">
Brien, Chris, Nathaniel Jewell, Stephanie J. Watts-Williams, Trevor
Garnett, and Bettina Berger. 2020. <span>“Smoothing and Extraction of
Traits in the Growth Analysis of Noninvasive Phenotypic Data.”</span>
<em>Plant Methods</em> 16 (1): 36. <a href="https://doi.org/10.1186/s13007-020-00577-6" class="external-link">https://doi.org/10.1186/s13007-020-00577-6</a>.
</div>
<div id="ref-Perez2022" class="csl-entry">
Pérez-Valencia, Diana M, María Xosé Rodríguez-Álvarez, Martin P Boer,
Lukas Kronenberg, Andreas Hund, Llorenç Cabrera-Bosquet, Emilie J
Millet, and Fred A van Eeuwijk. 2022. <span>“A Two-Stage Approach for
the Spatio-Temporal Analysis of High-Throughput Phenotyping
Data.”</span> <em>Scientific Reports</em> 12 (1): 1–16. <a href="https://doi.org/10.1038/s41598-022-06935-9" class="external-link">https://doi.org/10.1038/s41598-022-06935-9</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
