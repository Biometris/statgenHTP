<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>statgenHTP tutorial: 5. Modelling the temporal evolution of the genetic signal • statgenHTP</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="statgenHTP tutorial: 5. Modelling the temporal evolution of the genetic signal">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">statgenHTP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../index.html" aria-label="home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../../articles/index.html">Vignettes</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenHTP"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>statgenHTP tutorial: 5. Modelling the temporal evolution of the genetic signal</h1>
                        <h4 data-toc-skip class="author">Diana M.
Pérez-Valencia, María Xosé Rodríguez-Álvarez, Bart-Jan van Rossum,
Emilie Millet, Martin Boer, Fred van Eeuwijk</h4>
            
            <h4 data-toc-skip class="date">2025-07-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenHTP/blob/main/vignettes/vignettesSite/HierarchicalDataModel_HTP.Rmd" class="external-link"><code>vignettes/vignettesSite/HierarchicalDataModel_HTP.Rmd</code></a></small>
      <div class="d-none name"><code>HierarchicalDataModel_HTP.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document presents the second stage of the two-stage approach
proposed by <span class="citation">Pérez-Valencia et al. (<a href="#ref-Perez2022">2022</a>)</span>. The aim is modeling the temporal
evolution of the genetic signal after a spatial correction is performed
on a phenotypic trait (see <a href="SpatialModel_HTP.html"><strong>statgenHTP tutorial: 3. Correction
for spatial trends</strong></a>).</p>
<p>Data consist of time-series (curves) of a (possibly) spatially
corrected plant/plot phenotype. We assume that data present a
hierarchical structure with plots nested in genotypes, and genotypes
nested in “populations”. We denote as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̃</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{y}_{pgi}(t)</annotation></semantics></math>
the spatially corrected phenotype for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
plant
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>m</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">i = 1,\ldots,m_{pg}</annotation></semantics></math>)
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>th
genotype
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mo>ℓ</mo><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">g=1,\ldots,\ell_p</annotation></semantics></math>
in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>th
population
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">p= 1,\ldots, k</annotation></semantics></math>)
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
As such, there is a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mrow><msubsup><mo>∑</mo><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><msub><mo>ℓ</mo><mi>p</mi></msub></msubsup><msub><mi>m</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">M=\sum_{p=1}^k{\sum_{g=1}^{\ell_p}{m_{pg}}}</annotation></semantics></math>
plots/plants,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mo>ℓ</mo><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">L=\sum_{p=1}^k{\ell_p}</annotation></semantics></math>
genotypes, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
populations. To model this sample of curves the following additive
decomposition of the phenotypic variation over time is considered, and a
P-spline-based three-level nested hierarchical data model (hereafter
refer as <strong>psHDM</strong>) is used</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̃</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ε</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><msub><mi>ε</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><msub><mi>w</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\tilde{y}_{pgi}(t) = f_{p}(t) + f_{pg}(t) + f_{pgi}(t) + \varepsilon_{pgi}(t),\;\;\varepsilon_{pgi}(t)\sim N\left(0, \sigma^{2}w_{pgi}(t)\right),</annotation></semantics></math></p>
<p>where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>p</mi></msub><annotation encoding="application/x-tex">f_{p}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>th
population mean function.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">f_{pg}</annotation></semantics></math>
is the genotype-specific deviation from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>p</mi></msub><annotation encoding="application/x-tex">f_p</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>th
genotype. Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>p</mi></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{p} + f_{pg}</annotation></semantics></math>
represents the genotype-specific trajectory for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>th
genotype.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">f_{pgi}</annotation></semantics></math>
is the plot-specific deviation from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">f_{pg}</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
plot. In the same way than for the genotypes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>p</mi></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{p} + f_{pg} + f_{pgi}</annotation></semantics></math>
is the plot-specific trajectory for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
plot.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ε</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\varepsilon_{pgi}</annotation></semantics></math>
is the random noise curve, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">w_{pgi}</annotation></semantics></math>
is the weight obtained from, e.g., the spatial correction.</li>
</ul>
<p>An illustration of these curves follows</p>
<p><img src="figures/curvesHDM.png" width="80%" style="display: block; margin: auto;"></p>
<p>Before proceeding, we note that the functions described in this
tutorial can be applied to both spatially corrected data (see <a href="SpatialModel_HTP.html"><strong>statgenHTP tutorial: 3. Correction
for spatial trends</strong></a>) or raw data. These functions also allow
estimating first- and second-order derivative curves from trajectory and
deviation curves at the three levels of the hierarchy (populations,
genotypes and plots/plants). All these curves can be used as input to
extract time‐independent parameters to characterise genotypes (see <a href="ParameterEstimation_HTP.html"><strong>statgenHTP tutorial: 6.
Estimation of parameters from time courses</strong></a>).</p>
<p>To illustrate the analysis, we use the maize data corrected for
spatial trends, <code>spatCorrectedArch</code>. The data structure is as
follows</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40573 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ timeNumber   : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ timePoint    : POSIXct, format: "2017-04-13" "2017-04-13" ...</span></span>
<span><span class="co">#&gt;  $ LeafArea_corr: num  0.00256 0.0024 0.00321 0.00303 0.00269 ...</span></span>
<span><span class="co">#&gt;  $ LeafArea     : num  0.00287 0.00252 0.00338 0.00326 0.00249 ...</span></span>
<span><span class="co">#&gt;  $ wt           : num  2262 2262 2262 2262 2262 ...</span></span>
<span><span class="co">#&gt;  $ genotype     : Factor w/ 90 levels "GenoA01","GenoA02",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ geno.decomp  : Factor w/ 4 levels "WD_Panel1","WD_Panel2",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ rowId        : int  2 3 26 24 56 38 60 16 24 52 ...</span></span>
<span><span class="co">#&gt;  $ colId        : int  16 28 24 20 21 16 20 24 21 28 ...</span></span>
<span><span class="co">#&gt;  $ plotId       : Factor w/ 1673 levels "c10r1","c10r10",..: 368 1156 914 672 767 388 712 903 732 1181 ...</span></span></code></pre></div>
<p>For this specific example we first need to specify the
genotype-by-treatment interaction (genotype-by-water regime). As is
explained in <span class="citation">Pérez-Valencia et al. (<a href="#ref-Perez2022">2022</a>)</span>, the actual implementation of the
<strong>psHDM</strong> model does not allow for crossed effect, but only
for nested effects. As such, to analyse this dataset with the proposed
model, we combine the genotype and the water regime information as
follows (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>180</mn><annotation encoding="application/x-tex">180</annotation></semantics></math><code>genoTreat</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>90</mn><annotation encoding="application/x-tex">90</annotation></semantics></math><code>genotype</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math><code>treat</code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"geno.decomp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Factor w/ 4 levels "WD_Panel1","WD_Panel2",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genotype"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Factor w/ 90 levels "GenoA01","GenoA02",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span></span>
<span><span class="co">## Extracting the treatment: water regime (WW, WD).</span></span>
<span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"geno.decomp"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                                 start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Factor w/ 2 levels "WD","WW": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span></span>
<span><span class="co">## Specifying the genotype-by-treatment interaction.</span></span>
<span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genoTreat"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genotype"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>             <span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"treat"</span><span class="op">]</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"genoTreat"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Factor w/ 180 levels "GenoA01_WD","GenoA02_WD",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span></code></pre></div>
<p>We will use the spatially corrected leaf area
(<code>LeafArea_corr</code>) as response variable. We assume that plots
(<code>plotId</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>1673</mn></mrow><annotation encoding="application/x-tex">M = 1673</annotation></semantics></math>)
are nested in genotype-by-water regime (<code>genoTreat</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>180</mn></mrow><annotation encoding="application/x-tex">L = 180</annotation></semantics></math>),
and genotype-by-water regime are nested in populations/panel-by-water
regime (<code>geno.decomp</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k = 4</annotation></semantics></math>).
Furthermore, uncertainty is propagated from stage to stage using weights
(<code>wt</code>). Since we are in the context of longitudinal models,
it is natural that we use time as a covariate (i.e., the timepoints at
which the phenotype of interest was measured). We note that the
implemented function requires numerical times. If the
<code>timeNumber</code> column is used as it is returned by the
<code><a href="../../reference/getCorrected.html">getCorrected()</a></code> function, the user has to be aware that it
is a simple enumeration of the timepoints. Care must be taken when
dealing with non-equidistant timepoints to keep the same time scale as
in the original <code>timePoint</code> column. The user can also specify
any other numerical time transformation. For instance, in this example,
we first construct a new column called <code>DOY</code> with time in
days of the year</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a new timeNumber with days of the year (DOY)</span></span>
<span><span class="va">spatCorrectedArch</span><span class="op">[[</span><span class="st">"DOY"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">spatCorrectedArch</span><span class="op">$</span><span class="va">timePoint</span>, format <span class="op">=</span> <span class="st">"%j"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following code depicts the kind of curves that are modelled here
(at plant/plot level)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spatCorrectedArch</span>,</span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">DOY</span>, y <span class="op">=</span> <span class="va">LeafArea_corr</span>, group <span class="op">=</span> <span class="va">plotId</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">geno.decomp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Spatially corrected leaf area"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/visualiseData-1.png" width="672" style="display: block; margin: auto;"></p>
<hr>
</div>
<div class="section level2">
<h2 id="fit-the-p-spline-hierarchical-curve-data-model-pshdm">Fit the P-spline Hierarchical Curve Data Model (psHDM)<a class="anchor" aria-label="anchor" href="#fit-the-p-spline-hierarchical-curve-data-model-pshdm"></a>
</h2>
<p>To fit the <strong>psHDM</strong> model, we use the
<code><a href="../../reference/fitSplineHDM.html">fitSplineHDM()</a></code> function (results of the fitting process are
provided below)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fit P-Splines Hierarchical Curve Data Model for all genotypes.</span></span>
<span><span class="va">fit.psHDM</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitSplineHDM.html">fitSplineHDM</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedArch</span>,</span>
<span>                           trait <span class="op">=</span> <span class="st">"LeafArea_corr"</span>,</span>
<span>                           useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           timeNumber <span class="op">=</span> <span class="st">"DOY"</span>,</span>
<span>                           pop <span class="op">=</span> <span class="st">"geno.decomp"</span>,</span>
<span>                           genotype <span class="op">=</span> <span class="st">"genoTreat"</span>,</span>
<span>                           plotId <span class="op">=</span> <span class="st">"plotId"</span>,</span>
<span>                           weights <span class="op">=</span> <span class="st">"wt"</span>,</span>
<span>                           difVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                           smoothPop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothGeno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothPlot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>In the example above, we use cubic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>d</mi><mi>e</mi><mi>g</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">bdeg = 3</annotation></semantics></math>)
B-spline basis of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>p</mi><mi>o</mi><mi>p</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>g</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>p</mi><mi>l</mi><mi>o</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">b_{pop} = b_{gen} = b_{plot} = 10</annotation></semantics></math>
and second order penalties
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">pord = 2</annotation></semantics></math>)
to represent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>p</mi></msub><annotation encoding="application/x-tex">f_p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">f_{pg}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">f_{pgi}</annotation></semantics></math>.
We note that the <code><a href="../../reference/fitSplineHDM.html">fitSplineHDM()</a></code> function uses as argument
the number of segments <code>nseg</code> instead of the number of
B-spline basis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
(<code>nseg</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
- <code>bdeg</code>, that is, for our example, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">b = 10</annotation></semantics></math>
then <code>nseg</code> = 7). We encourage the user to try different
values for <code>nseg</code> and compare the results. Under this model
configuration, the mixed model formulation of the <strong>psHDM</strong>
model has a total of 18570 regression coefficients (both fixed and
random
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>10</mn><mo>+</mo><mn>180</mn><mo>×</mo><mn>10</mn><mo>+</mo><mn>1673</mn><mo>×</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">4 \times 10 + 180 \times 10 + 1673 \times 10</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>11</mn><annotation encoding="application/x-tex">11</annotation></semantics></math>
variance components. The fitting can also be performed for a subset of
genotypes or plots. The user only needs to specify the desired vector of
<code>genotypes</code> and/or <code>plotIds</code>.</p>
<blockquote>
<p>Note: If the user prefers to use different penalty orders and/or
B-spline degree values, the parameterisation proposed by <span class="citation">Wood, Scheipl, and Faraway (<a href="#ref-Wood2013">2013</a>)</span> is the one used by the
<code>fitSplineHDM</code> function to obtain the design matrix for the
fixed effects (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>)
in the mixed model formulation.</p>
</blockquote>
<p>If <code>useTimeNumber = FALSE</code>, an internal numerical
transformation of the time points (<code>timePoint</code>) is made (and
returned) using the first time point as origin.</p>
<p>In this example we are using the weights obtained after a spatial
correction is performed in a previous stage (i.e.,
<code>weights = wt</code>, with <code>wt</code> a column in
<code>spatCorrectedArch</code>). However, if
<code>weights = NULL</code>, the weights are considered to be one. For
instance, this could be the case of modelling raw data.</p>
<p>With the <code>difVar</code> argument, the user can also specify if
the genetic variation varies across populations
(<code>geno = TRUE</code>) and the plant variation changes across
genotypes (<code>plot = TRUE</code>). Consequently, the number of
variance components, <code>fit.psHDM$vc</code> (and effective dimension,
<code>fit.psHDM$ed</code>) will increase with the number of populations
and/or genotypes, while the number of coefficients will remain the
same.</p>
<p>If <code>trace = TRUE</code> a report with changes in deviance and
effective dimension is printed by iteration. It is useful to understand
the importance of model components <span class="citation">(<a href="#ref-RodAlv2018">Rodríguez-Álvarez et al. 2018</a>)</span>, as
well as to detect convergence problems.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fit P-Splines Hierarchical Curve Data Model for all genotypes.</span></span>
<span><span class="va">fit.psHDM</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/fitSplineHDM.html">fitSplineHDM</a></span><span class="op">(</span>inDat <span class="op">=</span> <span class="va">spatCorrectedArch</span>,</span>
<span>                           trait <span class="op">=</span> <span class="st">"LeafArea_corr"</span>,</span>
<span>                           useTimeNumber <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           timeNumber <span class="op">=</span> <span class="st">"DOY"</span>,</span>
<span>                           pop <span class="op">=</span> <span class="st">"geno.decomp"</span>,</span>
<span>                           genotype <span class="op">=</span> <span class="st">"genoTreat"</span>,</span>
<span>                           plotId <span class="op">=</span> <span class="st">"plotId"</span>,</span>
<span>                           weights <span class="op">=</span> <span class="st">"wt"</span>,</span>
<span>                           difVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                           smoothPop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothGeno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           smoothPlot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseg <span class="op">=</span> <span class="fl">7</span>, bdeg <span class="op">=</span> <span class="fl">3</span>, pord <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                           trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Effective dimensions</span></span>
<span><span class="co">#&gt; -------------------------</span></span>
<span><span class="co">#&gt; It.     Deviance        p1        p2        p3        p4     g.int     g.slp  g.smooth     i.int     i.slp  i.smooth</span></span>
<span><span class="co">#&gt;   1 -124003.216245     7.808     7.457     7.822     7.447   153.841   155.047  1086.529  1469.062  1513.633  8713.310</span></span>
<span><span class="co">#&gt;   2 -409208.877371     7.889     7.770     7.975     7.897   150.423   159.550   892.712  1236.532  1456.125  7041.664</span></span>
<span><span class="co">#&gt;   3 -412800.467660     7.910     7.787     7.983     7.925   157.527   162.575   803.841  1237.270  1465.159  5894.104</span></span>
<span><span class="co">#&gt;   4 -413841.057202     7.913     7.786     7.985     7.922   159.272   163.089   787.598  1286.468  1471.329  5195.497</span></span>
<span><span class="co">#&gt;   5 -414152.439567     7.914     7.783     7.985     7.918   159.443   163.042   790.487  1315.662  1474.828  4806.468</span></span>
<span><span class="co">#&gt;   6 -414237.155491     7.913     7.782     7.985     7.916   159.428   162.976   795.234  1328.862  1476.488  4604.336</span></span>
<span><span class="co">#&gt;   7 -414258.638613     7.913     7.780     7.985     7.914   159.431   162.949   798.454  1334.470  1477.223  4503.289</span></span>
<span><span class="co">#&gt;   8 -414263.887260     7.913     7.780     7.985     7.913   159.445   162.942   800.254  1336.873  1477.549  4453.660</span></span>
<span><span class="co">#&gt;   9 -414265.145823     7.913     7.779     7.985     7.913   159.458   162.941   801.189  1337.934  1477.696  4429.464</span></span>
<span><span class="co">#&gt;  10 -414265.444801     7.913     7.779     7.985     7.913   159.466   162.942   801.658  1338.419  1477.764  4417.702</span></span>
<span><span class="co">#&gt;  11 -414265.515495     7.913     7.779     7.985     7.913   159.470   162.942   801.890  1338.646  1477.796  4411.991</span></span>
<span><span class="co">#&gt;  12 -414265.532172     7.913     7.779     7.985     7.913   159.473   162.943   802.003  1338.754  1477.812  4409.220</span></span>
<span><span class="co">#&gt;  13 -414265.536102     7.913     7.779     7.985     7.913   159.474   162.943   802.058  1338.805  1477.819  4407.875</span></span>
<span><span class="co">#&gt;  14 -414265.537027     7.913     7.779     7.985     7.913   159.474   162.943   802.085  1338.830  1477.823  4407.222</span></span></code></pre></div>
<p>The resulting object, in this case <code>fit.psHDM</code>, contains
different information about the data structure, the fitting process, and
three data frames with the estimated curves at each of the three-levels
of the hierarchy (population, genotypes and plots). That is, it contains
the estimated trajectories and deviations, as well as their first and
second-order derivatives. For a detailed description of the returned
values see <code><a href="../../reference/fitSplineHDM.html">help(fitSplineHDM)</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "y"           "time"        "popLevs"     "genoLevs"    "plotLevs"   </span></span>
<span><span class="co">#&gt;  [6] "nPlotPop"    "nGenoPop"    "nPlotGeno"   "MM"          "ed"         </span></span>
<span><span class="co">#&gt; [11] "vc"          "phi"         "coeff"       "deviance"    "convergence"</span></span>
<span><span class="co">#&gt; [16] "dim"         "family"      "cholHn"      "smooth"      "popLevel"   </span></span>
<span><span class="co">#&gt; [21] "genoLevel"   "plotLevel"</span></span></code></pre></div>
<p>An example of the estimated curves structure follows.
<code>popLevel</code> contains, for each population (<code>pop</code>),
the estimated population trajectories
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><annotation encoding="application/x-tex">\hat{f}_p</annotation></semantics></math>,
<code>fPop</code>) as well as their first
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\hat{f}'_p</annotation></semantics></math>,
<code>fPopDeriv1</code>) and second-order
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\hat{f}''_p</annotation></semantics></math>,
<code>fPopDeriv2</code>) derivatives</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">popLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "timeNumber" "timePoint"  "pop"        "fPop"       "fPopDeriv1"</span></span>
<span><span class="co">#&gt; [6] "fPopDeriv2"</span></span></code></pre></div>
<table class="table">
<caption>Estimated curves at population level</caption>
<colgroup>
<col width="17%">
<col width="17%">
<col width="15%">
<col width="15%">
<col width="17%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">fPop</th>
<th align="center">fPopDeriv1</th>
<th align="center">fPopDeriv2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103</td>
<td align="center">2017-04-13</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0025168</td>
<td align="center">0.0006026</td>
<td align="center">0.0004741</td>
</tr>
<tr class="even">
<td align="center">104</td>
<td align="center">2017-04-14</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0033505</td>
<td align="center">0.0010588</td>
<td align="center">0.0004382</td>
</tr>
<tr class="odd">
<td align="center">105</td>
<td align="center">2017-04-15</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0046224</td>
<td align="center">0.0014789</td>
<td align="center">0.0004022</td>
</tr>
<tr class="even">
<td align="center">106</td>
<td align="center">2017-04-16</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0062964</td>
<td align="center">0.0018631</td>
<td align="center">0.0003662</td>
</tr>
<tr class="odd">
<td align="center">107</td>
<td align="center">2017-04-17</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0083366</td>
<td align="center">0.0022113</td>
<td align="center">0.0003302</td>
</tr>
<tr class="even">
<td align="center">108</td>
<td align="center">2017-04-18</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0107102</td>
<td align="center">0.0025459</td>
<td align="center">0.0003986</td>
</tr>
</tbody>
</table>
<p>Further, <code>genoLevel</code> contains, for each genotype
(<code>genotype</code>) in a population (<code>pop</code>)</p>
<ul>
<li><p>Estimated genotype deviations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\hat{f}_{pg}</annotation></semantics></math>,
<code>fGeno</code>) as well as their first
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}'_{pg}</annotation></semantics></math>,
<code>fGenoDeriv1</code>) and second-order
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}''_{pg}</annotation></semantics></math>,
<code>fGenoDeriv2</code>) derivatives.</p></li>
<li><p>Estimated genotype trajectories
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}_{p} +\hat{f}_{pg}</annotation></semantics></math>,
<code>fGenoDev</code>) as well as their first
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mi>p</mi></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}'_{p} +\hat{f}'_{pg}</annotation></semantics></math>,
<code>fGenoDevDeriv1</code>) and second-order
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mi>p</mi></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}''_{p} +\hat{f}''_{pg}</annotation></semantics></math>,
<code>fGenoDevDeriv2</code>) derivatives.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">genoLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "timeNumber"     "timePoint"      "pop"            "genotype"      </span></span>
<span><span class="co">#&gt;  [5] "fGeno"          "fGenoDeriv1"    "fGenoDeriv2"    "fGenoDev"      </span></span>
<span><span class="co">#&gt;  [9] "fGenoDevDeriv1" "fGenoDevDeriv2"</span></span></code></pre></div>
<table class="table">
<caption>Estimated curves at genotype level</caption>
<colgroup>
<col width="9%">
<col width="9%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="9%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">genotype</th>
<th align="center">fGeno</th>
<th align="center">fGenoDeriv1</th>
<th align="center">fGenoDeriv2</th>
<th align="center">fGenoDev</th>
<th align="center">fGenoDevDeriv1</th>
<th align="center">fGenoDevDeriv2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103</td>
<td align="center">2017-04-13</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0026216</td>
<td align="center">0.0005841</td>
<td align="center">0.0004948</td>
<td align="center">0.0001048</td>
<td align="center">-0.0000185</td>
<td align="center">2.06e-05</td>
</tr>
<tr class="even">
<td align="center">104</td>
<td align="center">2017-04-14</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0034437</td>
<td align="center">0.0010507</td>
<td align="center">0.0004385</td>
<td align="center">0.0000932</td>
<td align="center">-0.0000080</td>
<td align="center">3.00e-07</td>
</tr>
<tr class="odd">
<td align="center">105</td>
<td align="center">2017-04-15</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0047043</td>
<td align="center">0.0014611</td>
<td align="center">0.0003822</td>
<td align="center">0.0000819</td>
<td align="center">-0.0000179</td>
<td align="center">-2.00e-05</td>
</tr>
<tr class="even">
<td align="center">106</td>
<td align="center">2017-04-16</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0063471</td>
<td align="center">0.0018152</td>
<td align="center">0.0003259</td>
<td align="center">0.0000507</td>
<td align="center">-0.0000480</td>
<td align="center">-4.03e-05</td>
</tr>
<tr class="odd">
<td align="center">107</td>
<td align="center">2017-04-17</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0083158</td>
<td align="center">0.0021129</td>
<td align="center">0.0002696</td>
<td align="center">-0.0000208</td>
<td align="center">-0.0000984</td>
<td align="center">-6.06e-05</td>
</tr>
<tr class="even">
<td align="center">108</td>
<td align="center">2017-04-18</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0105575</td>
<td align="center">0.0023776</td>
<td align="center">0.0003217</td>
<td align="center">-0.0001527</td>
<td align="center">-0.0001682</td>
<td align="center">-7.68e-05</td>
</tr>
</tbody>
</table>
<p>Finally, <code>plotLevel</code> contains, for each plot
(<code>plotId</code>) in a genotype (<code>genotype</code>) in a
population (<code>pop</code>)</p>
<ul>
<li><p>Estimated plot deviations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\hat{f}_{pgi}</annotation></semantics></math>,
<code>fPlot</code>) as well as their first
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}'_{pgi}</annotation></semantics></math>,
<code>fPlotDeriv1</code>) and second-order
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}''_{pgi}</annotation></semantics></math>,
<code>fPlotDeriv2</code>) derivatives.</p></li>
<li><p>Estimated plot trajectories
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}_{p} +\hat{f}_{pg}+\hat{f}_{pgi}</annotation></semantics></math>,
<code>fPlotDev</code>) as well as their first
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mi>p</mi></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}'_{p} +\hat{f}'_{pg}+\hat{f}'_{pgi}</annotation></semantics></math>,
<code>fPlotDevDeriv1</code>) and second-order
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mi>p</mi></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>″</mi><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{f}''_{p} +\hat{f}''_{pg}+\hat{f}''_{pgi}</annotation></semantics></math>,
<code>fPlotDevDeriv2</code>) derivatives.</p></li>
<li><p>The original <code>trait</code> values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">̃</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{y}_{pgi}</annotation></semantics></math>,
<code>ObsPlot</code>).</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">plotLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "timeNumber"     "timePoint"      "pop"            "genotype"      </span></span>
<span><span class="co">#&gt;  [5] "plotId"         "fPlot"          "fPlotDeriv1"    "fPlotDeriv2"   </span></span>
<span><span class="co">#&gt;  [9] "fPlotDev"       "fPlotDevDeriv1" "fPlotDevDeriv2" "obsPlot"</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Estimated curves at plot level</caption>
<colgroup>
<col width="8%">
<col width="8%">
<col width="7%">
<col width="8%">
<col width="5%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">genotype</th>
<th align="center">plotId</th>
<th align="center">fPlot</th>
<th align="center">fPlotDeriv1</th>
<th align="center">fPlotDeriv2</th>
<th align="center">fPlotDev</th>
<th align="center">fPlotDevDeriv1</th>
<th align="center">fPlotDevDeriv2</th>
<th align="center">obsPlot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103</td>
<td align="center">2017-04-13</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0028737</td>
<td align="center">0.0002559</td>
<td align="center">0.0005414</td>
<td align="center">0.0002521</td>
<td align="center">-0.0003282</td>
<td align="center">4.66e-05</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">104</td>
<td align="center">2017-04-14</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0033886</td>
<td align="center">0.0007624</td>
<td align="center">0.0004717</td>
<td align="center">-0.0000550</td>
<td align="center">-0.0002883</td>
<td align="center">3.32e-05</td>
<td align="center">0.0032766</td>
</tr>
<tr class="odd">
<td align="center">105</td>
<td align="center">2017-04-15</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0043753</td>
<td align="center">0.0011992</td>
<td align="center">0.0004020</td>
<td align="center">-0.0003290</td>
<td align="center">-0.0002619</td>
<td align="center">1.98e-05</td>
<td align="center">0.0041821</td>
</tr>
<tr class="even">
<td align="center">106</td>
<td align="center">2017-04-16</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0057639</td>
<td align="center">0.0015664</td>
<td align="center">0.0003323</td>
<td align="center">-0.0005832</td>
<td align="center">-0.0002488</td>
<td align="center">6.40e-06</td>
<td align="center">0.0056382</td>
</tr>
<tr class="odd">
<td align="center">107</td>
<td align="center">2017-04-17</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0074848</td>
<td align="center">0.0018638</td>
<td align="center">0.0002626</td>
<td align="center">-0.0008311</td>
<td align="center">-0.0002491</td>
<td align="center">-7.00e-06</td>
<td align="center">0.0085059</td>
</tr>
<tr class="even">
<td align="center">108</td>
<td align="center">2017-04-18</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0094719</td>
<td align="center">0.0021169</td>
<td align="center">0.0003114</td>
<td align="center">-0.0010856</td>
<td align="center">-0.0002607</td>
<td align="center">-1.04e-05</td>
<td align="center">0.0095675</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="predict-the-p-spline-hierarchical-curve-data-model">Predict the P-spline Hierarchical Curve Data Model<a class="anchor" aria-label="anchor" href="#predict-the-p-spline-hierarchical-curve-data-model"></a>
</h2>
<p>The <code><a href="../../reference/predict.psHDM.html">predict.psHDM()</a></code> function can be used to obtain
predictions from a fitted <strong>psHDM</strong> model (obtained using
the <code><a href="../../reference/fitSplineHDM.html">fitSplineHDM()</a></code> function; see above). In particular,
this function allows obtaining predictions (estimated curves at each
level of the hierarchy) on a dense grid of time points. Also, it allows
the calculation of standard errors. These standard errors can be used to
construct (approximate) pointwise confidence intervals for the estimated
curves.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Predict the P-Splines Hierarchical Curve Data Model on a dense grid</span></span>
<span><span class="co">## with standard errors at the population and genotype levels</span></span>
<span><span class="va">pred.psHDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit.psHDM</span>,</span>
<span>                      newtimes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fit.psHDM</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="st">"timeNumber"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                     length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                      pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                      se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="cn">TRUE</span>, geno <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                      trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Note 1: If <code>newtimes</code> are not especified, the original
time points are used.</p>
</blockquote>
<blockquote>
<p>Note 2: As a hierarchical model is assumed, predictions at inner
levels (genotypes and plots) require predictions at outer levels
(populations and genotypes). That is, if the user only wants predictions
(argument <code>pred</code>) at genotype level
(<code>geno = TRUE</code>), then predictions at population level
(<code>pop = TRUE</code>) should be calculated as well.</p>
</blockquote>
<blockquote>
<p>Note 3: Standard errors (argument <code>se</code>) at the plot level
demand large computing memory and time. For this example, if we use the
original time points, estimation take approximately 20 minutes in a
(64-bit) 4.2.1 and a 1.60GHz Dual-Core i5 processor computer with 16GB
of RAM and macOS Monterrey Version 12.5. As such, if it is not strictly
necessary, we suggest the user to set the standard errors at the
<code>plot</code> level as <code>FALSE</code>. For comparison, if
<code>plot = FALSE</code> for the standard errors argument, the
computation time for the same example is 4 seconds approximately.</p>
</blockquote>
<p>In the code above, we use the <code>fit.psHDM</code> object to make
predictions at the three levels of the hierarchy
(<code>pred = list(pop = TRUE, geno = TRUE, plot = TRUE)</code>), and to
obtain standard errors at the population and genotype levels
(<code>se = list(pop = TRUE, geno = TRUE, plot = FALSE)</code>). The
original data is measured at 33 time points, but predictions are
obtained at 100 time points in the same range than the original time
points (argument <code>newtimes</code>). As result, three data frames
with predictions (and standard errors) at population
(<code>popLevel</code>), genotype (<code>GenoLevel</code>) and plot
(<code>plotLevel</code>) levels are returned</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pred.psHDM</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "newtimes"  "popLevel"  "genoLevel" "plotLevel" "plotObs"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pred.psHDM</span><span class="op">$</span><span class="va">popLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "timeNumber"  "timePoint"   "pop"         "fPop"        "fPopDeriv1" </span></span>
<span><span class="co">#&gt; [6] "fPopDeriv2"  "sePop"       "sePopDeriv1" "sePopDeriv2"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pred.psHDM</span><span class="op">$</span><span class="va">GenoLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pred.psHDM</span><span class="op">$</span><span class="va">plotLevel</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "timeNumber"     "timePoint"      "pop"            "genotype"      </span></span>
<span><span class="co">#&gt;  [5] "plotId"         "fPlot"          "fPlotDeriv1"    "fPlotDeriv2"   </span></span>
<span><span class="co">#&gt;  [9] "fPlotDev"       "fPlotDevDeriv1" "fPlotDevDeriv2"</span></span></code></pre></div>
<blockquote>
<p>Note 4: If the original time points are used for predictions, the
data frame at plot level (<code>plotLevel</code>) will have an
additional column (<code>obsPlot</code>) with the raw data. Otherwise,
an additional data frame (<code>plotObs</code>) with the raw data will
be returned.</p>
</blockquote>
<table class="table">
<caption>Predicted curves and standard errors at population
level</caption>
<colgroup>
<col width="10%">
<col width="18%">
<col width="9%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="9%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">fPop</th>
<th align="center">fPopDeriv1</th>
<th align="center">fPopDeriv2</th>
<th align="center">sePop</th>
<th align="center">sePopDeriv1</th>
<th align="center">sePopDeriv2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103.0000</td>
<td align="center">2017-04-13 00:00:00</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0025168</td>
<td align="center">0.0006026</td>
<td align="center">0.0004741</td>
<td align="center">0.0010397</td>
<td align="center">0.0002835</td>
<td align="center">5.17e-05</td>
</tr>
<tr class="even">
<td align="center">103.3232</td>
<td align="center">2017-04-13 07:45:27</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0027362</td>
<td align="center">0.0007540</td>
<td align="center">0.0004625</td>
<td align="center">0.0010198</td>
<td align="center">0.0002789</td>
<td align="center">4.74e-05</td>
</tr>
<tr class="odd">
<td align="center">103.6465</td>
<td align="center">2017-04-13 15:30:54</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0030038</td>
<td align="center">0.0009016</td>
<td align="center">0.0004509</td>
<td align="center">0.0010074</td>
<td align="center">0.0002752</td>
<td align="center">4.32e-05</td>
</tr>
<tr class="even">
<td align="center">103.9697</td>
<td align="center">2017-04-13 23:16:21</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0033186</td>
<td align="center">0.0010455</td>
<td align="center">0.0004392</td>
<td align="center">0.0010025</td>
<td align="center">0.0002720</td>
<td align="center">3.93e-05</td>
</tr>
<tr class="odd">
<td align="center">104.2929</td>
<td align="center">2017-04-14 07:01:49</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0036793</td>
<td align="center">0.0011856</td>
<td align="center">0.0004276</td>
<td align="center">0.0010048</td>
<td align="center">0.0002692</td>
<td align="center">3.56e-05</td>
</tr>
<tr class="even">
<td align="center">104.6162</td>
<td align="center">2017-04-14 14:47:16</td>
<td align="center">WD_Panel1</td>
<td align="center">0.0040847</td>
<td align="center">0.0013219</td>
<td align="center">0.0004160</td>
<td align="center">0.0010143</td>
<td align="center">0.0002667</td>
<td align="center">3.23e-05</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Predicted curves and standard errors at genotype
level</caption>
<colgroup>
<col width="5%">
<col width="9%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="7%">
<col width="7%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="5%">
<col width="7%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">genotype</th>
<th align="center">fGeno</th>
<th align="center">fGenoDeriv1</th>
<th align="center">fGenoDeriv2</th>
<th align="center">fGenoDev</th>
<th align="center">fGenoDevDeriv1</th>
<th align="center">fGenoDevDeriv2</th>
<th align="center">seGeno</th>
<th align="center">seGenoDeriv1</th>
<th align="center">seGenoDeriv2</th>
<th align="center">seGenoDev</th>
<th align="center">seGenoDevDeriv1</th>
<th align="center">seGenoDevDeriv2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103.0000</td>
<td align="center">2017-04-13 00:00:00</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0026216</td>
<td align="center">0.0005841</td>
<td align="center">0.0004948</td>
<td align="center">0.0001048</td>
<td align="center">-1.85e-05</td>
<td align="center">2.06e-05</td>
<td align="center">0.0018419</td>
<td align="center">0.0005717</td>
<td align="center">0.0001888</td>
<td align="center">0.0020863</td>
<td align="center">0.0006259</td>
<td align="center">0.0001870</td>
</tr>
<tr class="even">
<td align="center">103.3232</td>
<td align="center">2017-04-13 07:45:27</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0028359</td>
<td align="center">0.0007411</td>
<td align="center">0.0004766</td>
<td align="center">0.0000997</td>
<td align="center">-1.29e-05</td>
<td align="center">1.41e-05</td>
<td align="center">0.0017929</td>
<td align="center">0.0005450</td>
<td align="center">0.0001722</td>
<td align="center">0.0020349</td>
<td align="center">0.0006016</td>
<td align="center">0.0001706</td>
</tr>
<tr class="odd">
<td align="center">103.6465</td>
<td align="center">2017-04-13 15:30:54</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0031000</td>
<td align="center">0.0008922</td>
<td align="center">0.0004584</td>
<td align="center">0.0000962</td>
<td align="center">-9.40e-06</td>
<td align="center">7.50e-06</td>
<td align="center">0.0017605</td>
<td align="center">0.0005243</td>
<td align="center">0.0001557</td>
<td align="center">0.0020013</td>
<td align="center">0.0005827</td>
<td align="center">0.0001545</td>
</tr>
<tr class="even">
<td align="center">103.9697</td>
<td align="center">2017-04-13 23:16:21</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0034120</td>
<td align="center">0.0010374</td>
<td align="center">0.0004402</td>
<td align="center">0.0000934</td>
<td align="center">-8.10e-06</td>
<td align="center">1.00e-06</td>
<td align="center">0.0017436</td>
<td align="center">0.0005088</td>
<td align="center">0.0001396</td>
<td align="center">0.0019845</td>
<td align="center">0.0005684</td>
<td align="center">0.0001388</td>
</tr>
<tr class="odd">
<td align="center">104.2929</td>
<td align="center">2017-04-14 07:01:49</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0037700</td>
<td align="center">0.0011768</td>
<td align="center">0.0004220</td>
<td align="center">0.0000907</td>
<td align="center">-8.80e-06</td>
<td align="center">-5.60e-06</td>
<td align="center">0.0017415</td>
<td align="center">0.0004974</td>
<td align="center">0.0001239</td>
<td align="center">0.0019839</td>
<td align="center">0.0005576</td>
<td align="center">0.0001235</td>
</tr>
<tr class="even">
<td align="center">104.6162</td>
<td align="center">2017-04-14 14:47:16</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">0.0041721</td>
<td align="center">0.0013102</td>
<td align="center">0.0004038</td>
<td align="center">0.0000875</td>
<td align="center">-1.17e-05</td>
<td align="center">-1.22e-05</td>
<td align="center">0.0017531</td>
<td align="center">0.0004891</td>
<td align="center">0.0001088</td>
<td align="center">0.0019985</td>
<td align="center">0.0005494</td>
<td align="center">0.0001090</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Predicted curves and standard errors at plot level</caption>
<colgroup>
<col width="8%">
<col width="14%">
<col width="7%">
<col width="8%">
<col width="5%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">timeNumber</th>
<th align="center">timePoint</th>
<th align="center">pop</th>
<th align="center">genotype</th>
<th align="center">plotId</th>
<th align="center">fPlot</th>
<th align="center">fPlotDeriv1</th>
<th align="center">fPlotDeriv2</th>
<th align="center">fPlotDev</th>
<th align="center">fPlotDevDeriv1</th>
<th align="center">fPlotDevDeriv2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">103.0000</td>
<td align="center">2017-04-13 00:00:00</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0028737</td>
<td align="center">0.0002559</td>
<td align="center">0.0005414</td>
<td align="center">0.0002521</td>
<td align="center">-0.0003282</td>
<td align="center">4.66e-05</td>
</tr>
<tr class="even">
<td align="center">103.3232</td>
<td align="center">2017-04-13 07:45:27</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0029843</td>
<td align="center">0.0004272</td>
<td align="center">0.0005188</td>
<td align="center">0.0001484</td>
<td align="center">-0.0003138</td>
<td align="center">4.22e-05</td>
</tr>
<tr class="odd">
<td align="center">103.6465</td>
<td align="center">2017-04-13 15:30:54</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0031491</td>
<td align="center">0.0005913</td>
<td align="center">0.0004963</td>
<td align="center">0.0000491</td>
<td align="center">-0.0003009</td>
<td align="center">3.79e-05</td>
</tr>
<tr class="even">
<td align="center">103.9697</td>
<td align="center">2017-04-13 23:16:21</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0033658</td>
<td align="center">0.0007481</td>
<td align="center">0.0004738</td>
<td align="center">-0.0000463</td>
<td align="center">-0.0002893</td>
<td align="center">3.36e-05</td>
</tr>
<tr class="odd">
<td align="center">104.2929</td>
<td align="center">2017-04-14 07:01:49</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0036319</td>
<td align="center">0.0008976</td>
<td align="center">0.0004513</td>
<td align="center">-0.0001381</td>
<td align="center">-0.0002792</td>
<td align="center">2.92e-05</td>
</tr>
<tr class="even">
<td align="center">104.6162</td>
<td align="center">2017-04-14 14:47:16</td>
<td align="center">WD_Panel1</td>
<td align="center">GenoA01_WD</td>
<td align="center">c12r20</td>
<td align="center">0.0039452</td>
<td align="center">0.0010398</td>
<td align="center">0.0004287</td>
<td align="center">-0.0002269</td>
<td align="center">-0.0002704</td>
<td align="center">2.49e-05</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="plot-the-p-spline-hierarchical-curve-data-model">Plot the P-spline Hierarchical Curve Data Model<a class="anchor" aria-label="anchor" href="#plot-the-p-spline-hierarchical-curve-data-model"></a>
</h2>
<p>The <code><a href="../../reference/plot.psHDM.html">plot.psHDM()</a></code> function plots <code>psHDM</code>
objects. We note that objects of class <code>psHDM</code> can be
obtained using both <code><a href="../../reference/fitSplineHDM.html">fitSplineHDM()</a></code> and
<code><a href="../../reference/predict.psHDM.html">predict.psHDM()</a></code> functions. In both cases, the resulting
object contains information about estimated trajectories, deviations and
first-order derivatives at the three levels of the hierarchy. As such,
plots of these curves can be obtained. In addition, when plots are
obtained from an object obtained using the <code><a href="../../reference/predict.psHDM.html">predict.psHDM()</a></code>
function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
pointwise confidence intervals are also depicted.</p>
<p>To illustrate the usage of function <code><a href="../../reference/plot.psHDM.html">plot.psHDM()</a></code>, we use
here the object <code>pred.psHDM</code> obtained in the prediction
section.</p>
<div class="section level3">
<h3 id="plots-at-population-level">Plots at population level<a class="anchor" aria-label="anchor" href="#plots-at-population-level"></a>
</h3>
<p>If <code>plotType = "popTra"</code>, estimated population-specific
trajectories are depicted
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_p(t)</annotation></semantics></math>)
separately for each population, and their
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
pointwise confidence intervals. Additionally, the grey lines represent
the observed <code>trait</code> that is used in the
<code>fitSplineHDM</code> function (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">̃</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{y}_{pgi}</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Population-specific trajectories.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"popTra"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/plotPredPopVator-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="plots-at-genotype-level">Plots at genotype level<a class="anchor" aria-label="anchor" href="#plots-at-genotype-level"></a>
</h3>
<p>At genotype level we can visualise three plots:</p>
<ul>
<li>If <code>plotType = "popGenoTra"</code>, estimated population
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_p(t)</annotation></semantics></math>)
and genotype-specific
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_p(t)+\hat{f}_{pg}(t)</annotation></semantics></math>)
trajectories are depicted for all genotypes separately for each
population.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
pointwise confidence intervals are depicted for the estimated population
trajectories.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">## Population and genotype-specific trajectories.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"popGenoTra"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/plotPredGenoTraVator-1.png" width="576" style="display: block; margin: auto;"></p>
<ul>
<li>If <code>plotType = "popGenoDeriv"</code>, first-order derivative of
the estimated population
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}'_p(t)</annotation></semantics></math>)
and genotype-specific
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mover><mi>f</mi><mo accent="true">̂</mo></mover><msub><mi>′</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}'_p(t)+\hat{f}'_{pg}(t)</annotation></semantics></math>)
trajectories are depicted for all genotypes separately for each
population.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
pointwise confidence intervals are depicted for estimated trajectories
at the population level.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">## First-order derivative of the population- and genotype-specific trajectories.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"popGenoDeriv"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/plotPredGenoDerivVator-1.png" width="576" style="display: block; margin: auto;"></p>
<ul>
<li>Finally, if <code>plotType = "GenoDev"</code>, estimated
genotype-specific deviations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_{pg}(t)</annotation></semantics></math>)
are depicted for all genotypes separately for each population.<br>
</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">## Genotype-specific deviations.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, plotType <span class="op">=</span> <span class="st">"genoDev"</span>, themeSizeHDM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/plotPredGenoDevVator-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="plots-at-plot-level">Plots at plot level<a class="anchor" aria-label="anchor" href="#plots-at-plot-level"></a>
</h3>
<p>Finally, if we are interested in obtaining plots at the plot level,
we use <code>plotType = "genoPlotTra"</code>. Here, estimated genotype
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_p(t)+\hat{f}_{pg}(t)</annotation></semantics></math>)
and plot-specific
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mi>p</mi><mi>g</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}_p(t)+\hat{f}_{pg}(t)+\hat{f}_{pgi}(t)</annotation></semantics></math>)
trajectories are depicted for all plots separately for a selection of
genotypes. Also,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
pointwise confidence intervals are depicted for the estimated
genotype-specific trajectories. For this <code>plotType</code>, the user
has the option to change names (<code>genotypeNames</code>) and/or order
(<code>genotypeOrder</code>) of the selected genotypes.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## As an example we used ten randomly selected genotypes </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">plot.genos</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">pred.psHDM</span><span class="op">$</span><span class="va">genoLevel</span><span class="op">$</span><span class="va">genotype</span>,<span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">names.genos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">plot.genos</span>, first <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">names.genos</span></span>
<span><span class="co">#&gt;  [1] "B25_WW" "A48_WD" "A43_WW" "A16_WW" "B25_WD" "A41_WD" "A45_WW" "A26_WW"</span></span>
<span><span class="co">#&gt;  [9] "A33_WW" "B27_WW"</span></span>
<span></span>
<span><span class="co">## Genotype- and plot-specific trajectories.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.psHDM</span>, </span>
<span>     plotType <span class="op">=</span> <span class="st">"genoPlotTra"</span>, </span>
<span>     genotypes <span class="op">=</span> <span class="va">plot.genos</span>, genotypeNames <span class="op">=</span> <span class="va">names.genos</span>,</span>
<span>     themeSizeHDM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="HierarchicalDataModel_HTP_files/figure-html/plotPredPlotVator-1.png" width="576"></p>
<hr>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Perez2022" class="csl-entry">
Pérez-Valencia, Diana M, María Xosé Rodríguez-Álvarez, Martin P Boer,
Lukas Kronenberg, Andreas Hund, Llorenç Cabrera-Bosquet, Emilie J
Millet, and Fred A van Eeuwijk. 2022. <span>“A Two-Stage Approach for
the Spatio-Temporal Analysis of High-Throughput Phenotyping
Data.”</span> <em>Scientific Reports</em> 12 (1): 1–16. <a href="https://doi.org/10.1038/s41598-022-06935-9" class="external-link">https://doi.org/10.1038/s41598-022-06935-9</a>.
</div>
<div id="ref-RodAlv2018" class="csl-entry">
Rodríguez-Álvarez, María, Martin P. Boer, Fred van Eeuwijk, and Paul H.
C. Eilers. 2018. <span>“Correcting for Spatial Heterogeneity in Plant
Breeding Experiments with p-Splines.”</span> <em>Spatial Statistics</em>
23 (October): 52–71. <a href="https://doi.org/10.1016/j.spasta.2017.10.003" class="external-link">https://doi.org/10.1016/j.spasta.2017.10.003</a>.
</div>
<div id="ref-Wood2013" class="csl-entry">
Wood, Simon N, Fabian Scheipl, and Julian J Faraway. 2013.
<span>“Straightforward Intermediate Rank Tensor Product Smoothing in
Mixed Models.”</span> <em>Statistics and Computing</em> 23 (3): 341–60.
<a href="https://doi.org/10.1007/s11222-012-9314-z" class="external-link">https://doi.org/10.1007/s11222-012-9314-z</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilie J Millet, Maria Xose Rodriguez Alvarez, Diana Marcela Perez Valencia, Isabelle Sanchez, Nadine Hilgert, Bart-Jan van Rossum, Fred van Eeuwijk, Martin Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
